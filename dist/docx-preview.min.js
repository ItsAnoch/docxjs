!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jszip")):"function"==typeof define&&define.amd?define(["exports","jszip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).docx={},e.JSZip)}(this,function(e,t){"use strict";var r;function n(e){return/^[^"'].*\s.*[^"']$/.test(e)?`'${e}'`:e}function s(e){let t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function a(e,t){try{const r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch{return`${t}${e}`}}function o(e,t){return e.reduce((e,r)=>(e[t(r)]=r,e),{})}function i(e){return e&&"object"==typeof e&&!Array.isArray(e)}function l(e,...t){if(!t.length)return e;const r=t.shift();if(i(e)&&i(r))for(const t in r)if(i(r[t])){l(e[t]??(e[t]={}),r[t])}else e[t]=r[t];return l(e,...t)}function c(e){return Array.isArray(e)?e:[e]}!function(e){e.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",e.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",e.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",e.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",e.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",e.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",e.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",e.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",e.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",e.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",e.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",e.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",e.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",e.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",e.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",e.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",e.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",e.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",e.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"}(r||(r={}));const u="http://schemas.openxmlformats.org/wordprocessingml/2006/main",h={mul:.05,unit:"pt"},p={mul:1/12700,unit:"pt"},m={mul:.5,unit:"pt"},d={mul:.125,unit:"pt",min:.25,max:12},f={mul:1,unit:"pt"},g={mul:.02,unit:"%"};function b(e,t=h){if(null==e||/.+(p[xt]|[%])$/.test(e))return e;var r=parseInt(e)*t.mul;return t.min&&t.max&&(r=function(e,t,r){return t>e?t:r<e?r:e}(r,t.min,t.max)),`${r.toFixed(2)}${t.unit}`}function y(e,t,r){if(e.namespaceURI!=u)return!1;switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",m);break;default:return!1}return!0}class v{elements(e,t=null){const r=[];for(let n=0,s=e.childNodes.length;n<s;n++){let s=e.childNodes.item(n);1!=s.nodeType||null!=t&&s.localName!=t||r.push(s)}return r}element(e,t){for(let r=0,n=e.childNodes.length;r<n;r++){let n=e.childNodes.item(r);if(1==n.nodeType&&n.localName==t)return n}return null}elementAttr(e,t,r){var n=this.element(e,t);return n?this.attr(n,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,n=e.attributes.length;r<n;r++){let n=e.attributes.item(r);if(n.localName==t)return n.value}return null}intAttr(e,t,r=null){var n=this.attr(e,t);return n?parseInt(n):r}hexAttr(e,t,r=null){var n=this.attr(e,t);return n?parseInt(n,16):r}floatAttr(e,t,r=null){var n=this.attr(e,t);return n?parseFloat(n):r}boolAttr(e,t,r=null){return function(e,t=!1){switch(e){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}(this.attr(e,t),r)}lengthAttr(e,t,r=h){return b(this.attr(e,t),r)}}const N=new v;class E{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);const e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}const w={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function S(e,t){return t.elements(e).map(e=>function(e,t){let r={name:t.attr(e,"name"),embedFontRefs:[]};for(let n of t.elements(e))switch(n.localName){case"family":r.family=t.attr(n,"val");break;case"altName":r.altName=t.attr(n,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":r.embedFontRefs.push(A(n,t))}return r}(e,t))}function A(e,t){return{id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:w[e.localName]}}class k extends E{parseXml(e){this.fonts=S(e,this._package.xmlParser)}}class T{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new v}get(e){const t=function(e){return e.startsWith("/")?e.substr(1):e}(e);return this._zip.files[t]??this._zip.files[t.replace(/\//g,"\\")]}update(e,t){this._zip.file(e,t)}static async load(e,r){const n=await t.loadAsync(e);return new T(n,r)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";if(null!=e){const[r,n]=s(e);t=`${r}_rels/${n}.rels`}const r=await this.load(t);return r?(n=this.parseXmlDocument(r).firstElementChild,(a=this.xmlParser).elements(n).map(e=>({id:a.attr(e,"Id"),type:a.attr(e,"Type"),target:a.attr(e,"Target"),targetMode:a.attr(e,"TargetMode")}))):null;var n,a}parseXmlDocument(e){return function(e,t=!1){var r;t&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(r=e).charCodeAt(0)?r.substring(1):r;const n=(new DOMParser).parseFromString(e,"application/xml"),s=(a=n,a.getElementsByTagName("parsererror")[0]?.textContent);var a;if(s)throw new Error(s);return n}(e,this.options.trimXmlDeclaration)}}class C extends E{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function P(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",d),offset:t.lengthAttr(e,"space",f),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function x(e,t){var r={};for(let n of t.elements(e))switch(n.localName){case"left":r.left=P(n,t);break;case"top":r.top=P(n,t);break;case"right":r.right=P(n,t);break;case"bottom":r.bottom=P(n,t)}return r}var R,D;function M(e,t=N){var r={};for(let n of t.elements(e))switch(n.localName){case"pgSz":r.pageSize={width:t.lengthAttr(n,"w"),height:t.lengthAttr(n,"h"),orientation:t.attr(n,"orient")};break;case"type":r.type=t.attr(n,"val");break;case"pgMar":r.pageMargins={left:t.lengthAttr(n,"left"),right:t.lengthAttr(n,"right"),top:t.lengthAttr(n,"top"),bottom:t.lengthAttr(n,"bottom"),header:t.lengthAttr(n,"header"),footer:t.lengthAttr(n,"footer"),gutter:t.lengthAttr(n,"gutter")};break;case"cols":r.columns=O(n,t);break;case"headerReference":(r.headerRefs??(r.headerRefs=[])).push(_(n,t));break;case"footerReference":(r.footerRefs??(r.footerRefs=[])).push(_(n,t));break;case"titlePg":r.titlePage=t.boolAttr(n,"val",!0);break;case"pgBorders":r.pageBorders=x(n,t);break;case"pgNumType":r.pageNumber=L(n,t)}return r}function O(e,t){return{numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function L(e,t){return{chapSep:t.attr(e,"chapSep"),chapStyle:t.attr(e,"chapStyle"),format:t.attr(e,"fmt"),start:t.intAttr(e,"start")}}function _(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function I(e,t){let r={};for(let n of t.elements(e))B(n,r,t);return r}function B(e,t,r){return!!y(e,t,r)}function F(e,t){let r={};for(let n of t.elements(e))V(n,r,t);return r}function V(e,t,r){if(e.namespaceURI!=u)return!1;if(y(e,t,r))return!0;switch(e.localName){case"tabs":t.tabs=function(e,t){return t.elements(e,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}(e,r);break;case"sectPr":t.sectionProps=M(e,r);break;case"numPr":t.numbering=function(e,t){var r={};for(let n of t.elements(e))switch(n.localName){case"numId":r.id=t.attr(n,"val");break;case"ilvl":r.level=t.intAttr(n,"val")}return r}(e,r);break;case"spacing":return t.lineSpacing=function(e,t){return{before:t.lengthAttr(e,"before"),after:t.lengthAttr(e,"after"),line:t.intAttr(e,"line"),lineRule:t.attr(e,"lineRule")}}(e,r),!1;case"textAlignment":return t.textAlignment=r.attr(e,"val"),!1;case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=I(e,r);break;default:return!1}return!0}function H(e,t){let r={id:t.attr(e,"numId"),overrides:[]};for(let n of t.elements(e))switch(n.localName){case"abstractNumId":r.abstractId=t.attr(n,"val");break;case"lvlOverride":r.overrides.push(W(n,t))}return r}function $(e,t){let r={id:t.attr(e,"abstractNumId"),levels:[]};for(let n of t.elements(e))switch(n.localName){case"name":r.name=t.attr(n,"val");break;case"multiLevelType":r.multiLevelType=t.attr(n,"val");break;case"numStyleLink":r.numberingStyleLink=t.attr(n,"val");break;case"styleLink":r.styleLink=t.attr(n,"val");break;case"lvl":r.levels.push(U(n,t))}return r}function U(e,t){let r={level:t.intAttr(e,"ilvl")};for(let n of t.elements(e))switch(n.localName){case"start":r.start=t.attr(n,"val");break;case"lvlRestart":r.restart=t.intAttr(n,"val");break;case"numFmt":r.format=t.attr(n,"val");break;case"lvlText":r.text=t.attr(n,"val");break;case"lvlJc":r.justification=t.attr(n,"val");break;case"lvlPicBulletId":r.bulletPictureId=t.attr(n,"val");break;case"pStyle":r.paragraphStyle=t.attr(n,"val");break;case"pPr":r.paragraphProps=F(n,t);break;case"rPr":r.runProps=I(n,t)}return r}function W(e,t){let r={level:t.intAttr(e,"ilvl")};for(let n of t.elements(e))switch(n.localName){case"startOverride":r.start=t.intAttr(n,"val");break;case"lvl":r.numberingLevel=U(n,t)}return r}function j(e,t){var r=t.element(e,"pict"),n=r&&t.element(r,"shape"),s=n&&t.element(n,"imagedata");return s?{id:t.attr(e,"numPicBulletId"),referenceId:t.attr(s,"id"),style:t.attr(n,"style")}:null}!function(e){e.Continuous="continuous",e.NextPage="nextPage",e.NextColumn="nextColumn",e.EvenPage="evenPage",e.OddPage="oddPage"}(R||(R={}));class G extends E{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,function(e,t){let r={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let n of t.elements(e))switch(n.localName){case"num":r.numberings.push(H(n,t));break;case"abstractNum":r.abstractNumberings.push($(n,t));break;case"numPicBullet":r.bulletPictures.push(j(n,t))}return r}(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class q extends E{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}!function(e){e.Document="document",e.Paragraph="paragraph",e.Run="run",e.Break="break",e.NoBreakHyphen="noBreakHyphen",e.Table="table",e.Row="row",e.Cell="cell",e.Hyperlink="hyperlink",e.SmartTag="smartTag",e.Drawing="drawing",e.Image="image",e.Text="text",e.Tab="tab",e.Symbol="symbol",e.BookmarkStart="bookmarkStart",e.BookmarkEnd="bookmarkEnd",e.Footer="footer",e.Header="header",e.FootnoteReference="footnoteReference",e.EndnoteReference="endnoteReference",e.Footnote="footnote",e.Endnote="endnote",e.SimpleField="simpleField",e.ComplexField="complexField",e.Instruction="instruction",e.VmlPicture="vmlPicture",e.MmlMath="mmlMath",e.MmlMathParagraph="mmlMathParagraph",e.MmlFraction="mmlFraction",e.MmlFunction="mmlFunction",e.MmlFunctionName="mmlFunctionName",e.MmlNumerator="mmlNumerator",e.MmlDenominator="mmlDenominator",e.MmlRadical="mmlRadical",e.MmlBase="mmlBase",e.MmlDegree="mmlDegree",e.MmlSuperscript="mmlSuperscript",e.MmlSubscript="mmlSubscript",e.MmlPreSubSuper="mmlPreSubSuper",e.MmlSubArgument="mmlSubArgument",e.MmlSuperArgument="mmlSuperArgument",e.MmlNary="mmlNary",e.MmlDelimiter="mmlDelimiter",e.MmlRun="mmlRun",e.MmlEquationArray="mmlEquationArray",e.MmlLimit="mmlLimit",e.MmlLimitLower="mmlLimitLower",e.MmlMatrix="mmlMatrix",e.MmlMatrixRow="mmlMatrixRow",e.MmlBox="mmlBox",e.MmlBar="mmlBar",e.MmlGroupChar="mmlGroupChar",e.VmlElement="vmlElement",e.Inserted="inserted",e.Deleted="deleted",e.DeletedText="deletedText",e.Comment="comment",e.CommentReference="commentReference",e.CommentRangeStart="commentRangeStart",e.CommentRangeEnd="commentRangeEnd",e.AltChunk="altChunk"}(D||(D={}));class z{constructor(){this.children=[],this.cssStyle={}}}class X extends z{constructor(){super(...arguments),this.type=D.Header}}class Y extends z{constructor(){super(...arguments),this.type=D.Footer}}class J extends E{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class Q extends J{createRootElement(){return new X}}class K extends J{createRootElement(){return new Y}}function Z(e){if(void 0!==e)return parseInt(e)}class ee extends E{parseXml(e){this.props=function(e,t){const r={};for(let n of t.elements(e))switch(n.localName){case"Template":r.template=n.textContent;break;case"Pages":r.pages=Z(n.textContent);break;case"Words":r.words=Z(n.textContent);break;case"Characters":r.characters=Z(n.textContent);break;case"Application":r.application=n.textContent;break;case"Lines":r.lines=Z(n.textContent);break;case"Paragraphs":r.paragraphs=Z(n.textContent);break;case"Company":r.company=n.textContent;break;case"AppVersion":r.appVersion=n.textContent}return r}(e,this._package.xmlParser)}}class te extends E{parseXml(e){this.props=function(e,t){const r={};for(let n of t.elements(e))switch(n.localName){case"title":r.title=n.textContent;break;case"description":r.description=n.textContent;break;case"subject":r.subject=n.textContent;break;case"creator":r.creator=n.textContent;break;case"keywords":r.keywords=n.textContent;break;case"language":r.language=n.textContent;break;case"lastModifiedBy":r.lastModifiedBy=n.textContent;break;case"revision":n.textContent&&(r.revision=parseInt(n.textContent))}return r}(e,this._package.xmlParser)}}class re{}function ne(e,t){var r={name:t.attr(e,"name"),colors:{}};for(let a of t.elements(e)){var n=t.element(a,"srgbClr"),s=t.element(a,"sysClr");n?r.colors[a.localName]=t.attr(n,"val"):s&&(r.colors[a.localName]=t.attr(s,"lastClr"))}return r}function se(e,t){var r={name:t.attr(e,"name")};for(let n of t.elements(e))switch(n.localName){case"majorFont":r.majorFont=ae(n,t);break;case"minorFont":r.minorFont=ae(n,t)}return r}function ae(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class oe extends E{constructor(e,t){super(e,t)}parseXml(e){this.theme=function(e,t){var r=new re,n=t.element(e,"themeElements");for(let e of t.elements(n))switch(e.localName){case"clrScheme":r.colorScheme=ne(e,t);break;case"fontScheme":r.fontScheme=se(e,t)}return r}(e,this._package.xmlParser)}}class ie{}class le extends ie{constructor(){super(...arguments),this.type=D.Footnote}}class ce extends ie{constructor(){super(...arguments),this.type=D.Endnote}}class ue extends E{constructor(e,t,r){super(e,t),this._documentParser=r}}class he extends ue{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",le)}}class pe extends ue{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",ce)}}function me(e,t){var r={defaultNoteIds:[]};for(let n of t.elements(e))switch(n.localName){case"numFmt":r.nummeringFormat=t.attr(n,"val");break;case"footnote":case"endnote":r.defaultNoteIds.push(t.attr(n,"id"))}return r}class de extends E{constructor(e,t){super(e,t)}parseXml(e){this.settings=function(e,t){var r={};for(let n of t.elements(e))switch(n.localName){case"defaultTabStop":r.defaultTabStop=t.lengthAttr(n,"val");break;case"footnotePr":r.footnoteProps=me(n,t);break;case"endnotePr":r.endnoteProps=me(n,t);break;case"autoHyphenation":r.autoHyphenation=t.boolAttr(n,"val")}return r}(e,this._package.xmlParser)}}class fe extends E{parseXml(e){this.props=function(e,t){return t.elements(e,"property").map(e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}})}(e,this._package.xmlParser)}}class ge extends E{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=o(this.comments,e=>e.id)}}class be extends E{constructor(e,t){super(e,t),this.comments=[]}parseXml(e){const t=this._package.xmlParser;for(let r of t.elements(e,"commentEx"))this.comments.push({paraId:t.attr(r,"paraId"),paraIdParent:t.attr(r,"paraIdParent"),done:t.boolAttr(r,"done")});this.commentMap=o(this.comments,e=>e.paraId)}}const ye=[{type:r.OfficeDocument,target:"word/document.xml"},{type:r.ExtendedProperties,target:"docProps/app.xml"},{type:r.CoreProperties,target:"docProps/core.xml"},{type:r.CustomProperties,target:"docProps/custom.xml"}];class ve{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,r){var n=new ve;return n._options=r,n._parser=t,n._package=await T.load(e,r),n.rels=await n._package.loadRelationships(),await Promise.all(ye.map(e=>{const t=n.rels.find(t=>t.type===e.type)??e;return n.loadRelationshipPart(t.target,t.type)})),n}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let n=null;switch(t){case r.OfficeDocument:this.documentPart=n=new C(this._package,e,this._parser);break;case r.FontTable:this.fontTablePart=n=new k(this._package,e);break;case r.Numbering:this.numberingPart=n=new G(this._package,e,this._parser);break;case r.Styles:this.stylesPart=n=new q(this._package,e,this._parser);break;case r.Theme:this.themePart=n=new oe(this._package,e);break;case r.Footnotes:this.footnotesPart=n=new he(this._package,e,this._parser);break;case r.Endnotes:this.endnotesPart=n=new pe(this._package,e,this._parser);break;case r.Footer:n=new K(this._package,e,this._parser);break;case r.Header:n=new Q(this._package,e,this._parser);break;case r.CoreProperties:this.corePropsPart=n=new te(this._package,e);break;case r.ExtendedProperties:this.extendedPropsPart=n=new ee(this._package,e);break;case r.CustomProperties:n=new fe(this._package,e);break;case r.Settings:this.settingsPart=n=new de(this._package,e);break;case r.Comments:this.commentsPart=n=new ge(this._package,e,this._parser);break;case r.CommentsExtended:this.commentsExtendedPart=n=new be(this._package,e)}if(null==n)return Promise.resolve(null);if(this.partsMap[e]=n,this.parts.push(n),await n.load(),n.rels?.length>0){const[e]=s(n.path);await Promise.all(n.rels.map(t=>this.loadRelationshipPart(a(t.target,e),t.type)))}return n}async loadDocumentImage(e,t){const r=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(r)}async loadNumberingImage(e){const t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){const r=await this.loadResource(this.fontTablePart,e,"uint8array");return r?this.blobToURL(new Blob([Ne(r,t)])):r}async loadAltChunk(e,t){return await this.loadResource(t??this.documentPart,e,"string")}blobToURL(e){return e?this._options.useBase64URL?function(e){return new Promise((t,r)=>{const n=new FileReader;n.onloadend=()=>t(n.result),n.onerror=()=>r(),n.readAsDataURL(e)})}(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r=(t.rels??this.rels).find(t=>t.id==e);const n=t?s(t.path)[0]:"";return r?this.partsMap[a(r.target,n)]:null}getPathById(e,t){const r=e.rels.find(e=>e.id==t),[n]=s(e.path);return r?a(r.target,n):null}loadResource(e,t,r){const n=this.getPathById(e,t);return n?this._package.load(n,r):Promise.resolve(null)}}function Ne(e,t){const r=t.replace(/{|}|-/g,""),n=new Array(16);for(let e=0;e<16;e++)n[16-e-1]=parseInt(r.substr(2*e,2),16);for(let t=0;t<32;t++)e[t]=e[t]^n[t%16];return e}function Ee(e,t){return{type:D.BookmarkStart,id:t.attr(e,"id"),name:t.attr(e,"name"),colFirst:t.intAttr(e,"colFirst"),colLast:t.intAttr(e,"colLast")}}function we(e,t){return{type:D.BookmarkEnd,id:t.attr(e,"id")}}class Se extends z{constructor(){super(...arguments),this.type=D.VmlElement,this.attrs={}}}function Ae(e,t){var r=new Se;switch(e.localName){case"rect":r.tagName="rect",Object.assign(r.attrs,{width:"100%",height:"100%"});break;case"oval":r.tagName="ellipse",Object.assign(r.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":r.tagName="line";break;case"shape":r.tagName="g";break;case"textbox":r.tagName="foreignObject",Object.assign(r.attrs,{width:"100%",height:"100%"});break;default:return null}for(const t of N.attrs(e))switch(t.localName){case"style":r.cssStyleText=t.value;break;case"fillcolor":r.attrs.fill=t.value;break;case"from":const[e,n]=Ce(t.value);Object.assign(r.attrs,{x1:e,y1:n});break;case"to":const[s,a]=Ce(t.value);Object.assign(r.attrs,{x2:s,y2:a})}for(const n of N.elements(e))switch(n.localName){case"stroke":Object.assign(r.attrs,ke(n));break;case"fill":Object.assign(r.attrs,Te());break;case"imagedata":r.tagName="image",Object.assign(r.attrs,{width:"100%",height:"100%"}),r.imageHref={id:N.attr(n,"id"),title:N.attr(n,"title")};break;case"txbxContent":r.children.push(...t.parseBodyElements(n));break;default:const e=Ae(n,t);e&&r.children.push(e)}return r}function ke(e){return{stroke:N.attr(e,"color"),"stroke-width":N.lengthAttr(e,"weight",p)??"1px"}}function Te(e){return{}}function Ce(e){return e.split(",")}class Pe extends z{constructor(){super(...arguments),this.type=D.Comment}}class xe extends z{constructor(e){super(),this.id=e,this.type=D.CommentReference}}class Re extends z{constructor(e){super(),this.id=e,this.type=D.CommentRangeStart}}class De extends z{constructor(e){super(),this.id=e,this.type=D.CommentRangeEnd}}var Me="inherit",Oe="black",Le="black",_e="transparent";const Ie=[],Be={oMath:D.MmlMath,oMathPara:D.MmlMathParagraph,f:D.MmlFraction,func:D.MmlFunction,fName:D.MmlFunctionName,num:D.MmlNumerator,den:D.MmlDenominator,rad:D.MmlRadical,deg:D.MmlDegree,e:D.MmlBase,sSup:D.MmlSuperscript,sSub:D.MmlSubscript,sPre:D.MmlPreSubSuper,sup:D.MmlSuperArgument,sub:D.MmlSubArgument,d:D.MmlDelimiter,nary:D.MmlNary,eqArr:D.MmlEquationArray,lim:D.MmlLimit,limLow:D.MmlLimitLower,m:D.MmlMatrix,mr:D.MmlMatrixRow,box:D.MmlBox,bar:D.MmlBar,groupChr:D.MmlGroupChar};class Fe{constructor(e){this.options={ignoreWidth:!1,debug:!1,...e}}parseNotes(e,t,r){var n=[];for(let s of N.elements(e,t)){const e=new r;e.id=N.attr(s,"id"),e.noteType=N.attr(s,"type"),e.children=this.parseBodyElements(s),n.push(e)}return n}parseComments(e){var t=[];for(let r of N.elements(e,"comment")){const e=new Pe;e.id=N.attr(r,"id"),e.author=N.attr(r,"author"),e.initials=N.attr(r,"initials"),e.date=N.attr(r,"date"),e.children=this.parseBodyElements(r),t.push(e)}return t}parseDocumentFile(e){var t=N.element(e,"body"),r=N.element(e,"background"),n=N.element(t,"sectPr");return{type:D.Document,children:this.parseBodyElements(t),props:n?M(n,N):{},cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){var t={},r=He.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){var t=[];for(let r of N.elements(e))switch(r.localName){case"p":t.push(this.parseParagraph(r));break;case"altChunk":t.push(this.parseAltChunk(r));break;case"tbl":t.push(this.parseTable(r));break;case"sdt":t.push(...this.parseSdt(r,e=>this.parseBodyElements(e)))}return t}parseStylesFile(e){var t=[];return He.foreach(e,e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}}),t}parseDefaultStyles(e){var t={id:null,name:null,target:null,basedOn:null,styles:[]};return He.foreach(e,e=>{switch(e.localName){case"rPrDefault":var r=N.element(e,"rPr");r&&t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})});break;case"pPrDefault":var n=N.element(e,"pPr");n&&t.styles.push({target:"p",values:this.parseDefaultProperties(n,{})})}}),t}parseStyle(e){var t={id:N.attr(e,"styleId"),isDefault:N.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(N.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span"}return He.foreach(e,e=>{switch(e.localName){case"basedOn":t.basedOn=N.attr(e,"val");break;case"name":t.name=N.attr(e,"val");break;case"link":t.linked=N.attr(e,"val");break;case"next":t.next=N.attr(e,"val");break;case"aliases":t.aliases=N.attr(e,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),t.paragraphProps=F(e,N);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),t.runProps=I(e,N);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(let r of this.parseTableStyle(e))t.styles.push(r);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${e.localName}`)}}),t}parseTableStyle(e){var t=[],r=N.attr(e,"type"),n="",s="";switch(r){case"firstRow":s=".first-row",n="tr.first-row td";break;case"lastRow":s=".last-row",n="tr.last-row td";break;case"firstCol":s=".first-col",n="td.first-col";break;case"lastCol":s=".last-col",n="td.last-col";break;case"band1Vert":s=":not(.no-vband)",n="td.odd-col";break;case"band2Vert":s=":not(.no-vband)",n="td.even-col";break;case"band1Horz":s=":not(.no-hband)",n="tr.odd-row";break;case"band2Horz":s=":not(.no-hband)",n="tr.even-row";break;default:return[]}return He.foreach(e,e=>{switch(e.localName){case"pPr":t.push({target:`${n} p`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:`${n} span`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:n,mod:s,values:this.parseDefaultProperties(e,{})})}}),t}parseNumberingFile(e){var t=[],r={},n=[];return He.foreach(e,e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,n).forEach(e=>t.push(e));break;case"numPicBullet":n.push(this.parseNumberingPicBullet(e));break;case"num":var s=N.attr(e,"numId"),a=N.elementAttr(e,"abstractNumId","val");r[a]=s}}),t.forEach(e=>e.id=r[e.id]),t}parseNumberingPicBullet(e){var t=N.element(e,"pict"),r=t&&N.element(t,"shape"),n=r&&N.element(r,"imagedata");return n?{id:N.intAttr(e,"numPicBulletId"),src:N.attr(n,"id"),style:N.attr(r,"style")}:null}parseAbstractNumbering(e,t){var r=[],n=N.attr(e,"abstractNumId");return He.foreach(e,e=>{if("lvl"===e.localName)r.push(this.parseNumberingLevel(n,e,t))}),r}parseNumberingLevel(e,t,r){var n={id:e,level:N.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return He.foreach(t,e=>{switch(e.localName){case"start":n.start=N.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,n.pStyle);break;case"rPr":this.parseDefaultProperties(e,n.rStyle);break;case"lvlPicBulletId":var t=N.intAttr(e,"val");n.bullet=r.find(e=>e?.id==t);break;case"lvlText":n.levelText=N.attr(e,"val");break;case"pStyle":n.pStyleName=N.attr(e,"val");break;case"numFmt":n.format=N.attr(e,"val");break;case"suff":n.suff=N.attr(e,"val")}}),n}parseSdt(e,t){const r=N.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){return{type:D.Inserted,children:t(e)?.children??[]}}parseDeleted(e,t){return{type:D.Deleted,children:t(e)?.children??[]}}parseAltChunk(e){return{type:D.AltChunk,children:[],id:N.attr(e,"id")}}parseParagraph(e){var t={type:D.Paragraph,children:[]};for(let r of N.elements(e))switch(r.localName){case"pPr":this.parseParagraphProperties(r,t);break;case"r":t.children.push(this.parseRun(r,t));break;case"hyperlink":t.children.push(this.parseHyperlink(r,t));break;case"smartTag":t.children.push(this.parseSmartTag(r,t));break;case"bookmarkStart":t.children.push(Ee(r,N));break;case"bookmarkEnd":t.children.push(we(r,N));break;case"commentRangeStart":t.children.push(new Re(N.attr(r,"id")));break;case"commentRangeEnd":t.children.push(new De(N.attr(r,"id")));break;case"oMath":case"oMathPara":const e=this.parseMathElement(r);e._raw=r,t.children.push(e);break;case"sdt":t.children.push(...this.parseSdt(r,e=>this.parseParagraph(e).children));break;case"ins":t.children.push(this.parseInserted(r,e=>this.parseParagraph(e)));break;case"del":t.children.push(this.parseDeleted(r,e=>this.parseParagraph(e)))}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{if(V(e,t,N))return!0;switch(e.localName){case"pStyle":t.styleName=N.attr(e,"val");break;case"cnfStyle":t.className=$e.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0})}parseFrame(e,t){"drop"==N.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){var r={type:D.Hyperlink,parent:t,children:[]};return r.anchor=N.attr(e,"anchor"),r.id=N.attr(e,"id"),He.foreach(e,e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))}),r}parseSmartTag(e,t){var r={type:D.SmartTag,parent:t,children:[]},n=N.attr(e,"uri"),s=N.attr(e,"element");return n&&(r.uri=n),s&&(r.element=s),He.foreach(e,e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))}),r}parseRun(e,t){var r={type:D.Run,parent:t,children:[]};return He.foreach(e,e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":r.children.push({type:D.Text,text:e.textContent});break;case"delText":r.children.push({type:D.DeletedText,text:e.textContent});break;case"commentReference":r.children.push(new xe(N.attr(e,"id")));break;case"fldSimple":r.children.push({type:D.SimpleField,instruction:N.attr(e,"instr"),lock:N.boolAttr(e,"lock",!1),dirty:N.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:D.Instruction,text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:D.ComplexField,charType:N.attr(e,"fldCharType"),lock:N.boolAttr(e,"lock",!1),dirty:N.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:D.NoBreakHyphen});break;case"br":r.children.push({type:D.Break,break:N.attr(e,"type")||"textWrapping"});break;case"lastRenderedPageBreak":r.children.push({type:D.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:D.Symbol,font:n(N.attr(e,"font")),char:N.attr(e,"char")});break;case"tab":r.children.push({type:D.Tab});break;case"footnoteReference":r.children.push({type:D.FootnoteReference,id:N.attr(e,"id")});break;case"endnoteReference":r.children.push({type:D.EndnoteReference,id:N.attr(e,"id")});break;case"drawing":let t=this.parseDrawing(e);t&&(r.children=[t]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}}),r}parseMathElement(e){const t=`${e.localName}Pr`,r={type:Be[e.localName],children:[],_raw:e};for(const s of N.elements(e)){if(Be[s.localName])r.children.push(this.parseMathElement(s));else if("r"==s.localName){var n=this.parseRun(s);n.type=D.MmlRun,r.children.push(n)}else s.localName==t&&(r.props=this.parseMathProperies(s))}return r}parseMathProperies(e){const t={};for(const r of N.elements(e))switch(r.localName){case"chr":t.char=N.attr(r,"val");break;case"vertJc":t.verticalJustification=N.attr(r,"val");break;case"pos":t.position=N.attr(r,"val");break;case"degHide":t.hideDegree=N.boolAttr(r,"val");break;case"begChr":t.beginChar=N.attr(r,"val");break;case"endChr":t.endChar=N.attr(r,"val")}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,e=>{switch(e.localName){case"rStyle":t.styleName=N.attr(e,"val");break;case"vertAlign":t.verticalAlign=$e.valueOfVertAlign(e,!0);break;default:return!1}return!0})}parseVmlPicture(e){const t={type:D.VmlPicture,children:[]};for(const r of N.elements(e)){const e=Ae(r,this);e&&t.children.push(e)}return t}checkAlternateContent(e){if("AlternateContent"!=e.localName)return e;var t=N.element(e,"Choice");if(t){var r=N.attr(t,"Requires"),n=e.lookupNamespaceURI(r);if(Ie.includes(n))return t.firstElementChild}return N.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(var t of N.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t={type:D.Drawing,children:[],cssStyle:{}},r="anchor"==e.localName;let n=null,s=N.boolAttr(e,"simplePos");N.boolAttr(e,"behindDoc");let a={relative:"page",align:"left",offset:"0"},o={relative:"page",align:"top",offset:"0"};for(var i of N.elements(e))switch(i.localName){case"simplePos":s&&(a.offset=N.lengthAttr(i,"x",p),o.offset=N.lengthAttr(i,"y",p));break;case"extent":t.cssStyle.width=N.lengthAttr(i,"cx",p),t.cssStyle.height=N.lengthAttr(i,"cy",p);break;case"positionH":case"positionV":if(!s){let e="positionH"==i.localName?a:o;var l=N.element(i,"align"),c=N.element(i,"posOffset");e.relative=N.attr(i,"relativeFrom")??e.relative,l&&(e.align=l.textContent),c&&(e.offset=He.sizeValue(c,p))}break;case"wrapTopAndBottom":n="wrapTopAndBottom";break;case"wrapNone":n="wrapNone";break;case"graphic":var u=this.parseGraphic(i);u&&t.children.push(u)}return"wrapTopAndBottom"==n?(t.cssStyle.display="block",a.align&&(t.cssStyle["text-align"]=a.align,t.cssStyle.width="100%")):"wrapNone"==n?(t.cssStyle.display="block",t.cssStyle.position="relative",t.cssStyle.width="0px",t.cssStyle.height="0px",a.offset&&(t.cssStyle.left=a.offset),o.offset&&(t.cssStyle.top=o.offset)):!r||"left"!=a.align&&"right"!=a.align||(t.cssStyle.float=a.align),t}parseGraphic(e){var t=N.element(e,"graphicData");for(let e of N.elements(t))if("pic"===e.localName)return this.parsePicture(e);return null}parsePicture(e){var t={type:D.Image,src:"",cssStyle:{}},r=N.element(e,"blipFill"),n=N.element(r,"blip"),s=N.element(r,"srcRect");t.src=N.attr(n,"embed"),s&&(t.srcRect=[N.intAttr(s,"l",0)/1e5,N.intAttr(s,"t",0)/1e5,N.intAttr(s,"r",0)/1e5,N.intAttr(s,"b",0)/1e5]);var a=N.element(e,"spPr"),o=N.element(a,"xfrm");if(t.cssStyle.position="relative",o)for(var i of(t.rotation=N.intAttr(o,"rot",0)/6e4,N.elements(o)))switch(i.localName){case"ext":t.cssStyle.width=N.lengthAttr(i,"cx",p),t.cssStyle.height=N.lengthAttr(i,"cy",p);break;case"off":t.cssStyle.left=N.lengthAttr(i,"x",p),t.cssStyle.top=N.lengthAttr(i,"y",p)}return t}parseTable(e){var t={type:D.Table,children:[]};return He.foreach(e,e=>{switch(e.localName){case"tr":t.children.push(this.parseTableRow(e));break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tblPr":this.parseTableProperties(e,t)}}),t}parseTableColumns(e){var t=[];return He.foreach(e,e=>{if("gridCol"===e.localName)t.push({width:N.lengthAttr(e,"w")})}),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,e=>{switch(e.localName){case"tblStyle":t.styleName=N.attr(e,"val");break;case"tblLook":t.className=$e.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=N.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=N.intAttr(e,"val");break;case"hidden":t.cssStyle.display="none";break;default:return!1}return!0}),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){var r=N.lengthAttr(e,"topFromText"),n=N.lengthAttr(e,"bottomFromText"),s=N.lengthAttr(e,"rightFromText"),a=N.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=$e.addSize(t.cssStyle["margin-bottom"],n),t.cssStyle["margin-left"]=$e.addSize(t.cssStyle["margin-left"],a),t.cssStyle["margin-right"]=$e.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=$e.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){var t={type:D.Row,children:[]};return He.foreach(e,e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":case"tblPrEx":this.parseTableRowProperties(e,t)}}),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"cnfStyle":t.className=$e.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=N.boolAttr(e,"val");break;case"gridBefore":t.gridBefore=N.intAttr(e,"val");break;case"gridAfter":t.gridAfter=N.intAttr(e,"val");break;default:return!1}return!0})}parseTableCell(e){var t={type:D.Cell,children:[]};return He.foreach(e,e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}}),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,e=>{switch(e.localName){case"gridSpan":t.span=N.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=N.attr(e,"val")??"continue";break;case"cnfStyle":t.className=$e.classNameOfCnfStyle(e);break;default:return!1}return!0}),this.parseTableCellVerticalText(e,t)}parseTableCellVerticalText(e,t){const r={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};He.foreach(e,e=>{if("textDirection"===e.localName){const n=N.attr(e,"val"),s=r[n]||{writingMode:"horizontal-tb"};t.cssStyle["writing-mode"]=s.writingMode,t.cssStyle.transform=s.transform}})}parseDefaultProperties(e,t=null,r=null,n=null){return t=t||{},He.foreach(e,s=>{if(!n?.(s))switch(s.localName){case"jc":t["text-align"]=$e.valueOfJc(s);break;case"textAlignment":t["vertical-align"]=$e.valueOfTextAlignment(s);break;case"color":t.color=He.colorAttr(s,"val",null,Oe);break;case"sz":t["font-size"]=t["min-height"]=N.lengthAttr(s,"val",m);break;case"shd":t["background-color"]=He.colorAttr(s,"fill",null,Me);break;case"highlight":t["background-color"]=He.colorAttr(s,"val",null,_e);break;case"vertAlign":break;case"position":t.verticalAlign=N.lengthAttr(s,"val",m);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":t.width=$e.valueOfSize(s,"w");break;case"trHeight":this.parseTrHeight(s,t);break;case"strike":t["text-decoration"]=N.boolAttr(s,"val",!0)?"line-through":"none";break;case"b":t["font-weight"]=N.boolAttr(s,"val",!0)?"bold":"normal";break;case"i":t["font-style"]=N.boolAttr(s,"val",!0)?"italic":"normal";break;case"caps":t["text-transform"]=N.boolAttr(s,"val",!0)?"uppercase":"none";break;case"smallCaps":t["font-variant"]=N.boolAttr(s,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(s,t);break;case"ind":case"tblInd":this.parseIndentation(s,t);break;case"rFonts":this.parseFont(s,t);break;case"tblBorders":this.parseBorderProperties(s,r||t);break;case"tblCellSpacing":t["border-spacing"]=$e.valueOfMargin(s),t["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(s,t);break;case"bdr":t.border=$e.valueOfBorder(s);break;case"tcBorders":this.parseBorderProperties(s,t);break;case"vanish":N.boolAttr(s,"val",!0)&&(t.display="none");break;case"kern":case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(s,r||t);break;case"tblLayout":t["table-layout"]=$e.valueOfTblLayout(s);break;case"vAlign":t["vertical-align"]=$e.valueOfTextAlignment(s);break;case"spacing":"pPr"==e.localName&&this.parseSpacing(s,t);break;case"wordWrap":N.boolAttr(s,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=N.boolAttr(s,"val",!0)?"none":"auto";break;case"lang":t.$lang=N.attr(s,"val");break;case"rtl":case"bidi":N.boolAttr(s,"val",!0)&&(t.direction="rtl");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${s.localName}`)}}),t}parseUnderline(e,t){var r=N.attr(e,"val");if(null!=r){switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":case"words":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"none":t["text-decoration"]="none"}var n=He.colorAttr(e,"color");n&&(t["text-decoration-color"]=n)}}parseFont(e,t){var r=[N.attr(e,"ascii"),$e.themeValue(e,"asciiTheme"),N.attr(e,"eastAsia")].filter(e=>e).map(e=>n(e));r.length>0&&(t["font-family"]=[...new Set(r)].join(", "))}parseIndentation(e,t){var r=N.lengthAttr(e,"firstLine"),n=N.lengthAttr(e,"hanging"),s=N.lengthAttr(e,"left"),a=N.lengthAttr(e,"start"),o=N.lengthAttr(e,"right"),i=N.lengthAttr(e,"end");r&&(t["text-indent"]=r),n&&(t["text-indent"]=`-${n}`),(s||a)&&(t["margin-inline-start"]=s||a),(o||i)&&(t["margin-inline-end"]=o||i)}parseSpacing(e,t){var r=N.lengthAttr(e,"before"),n=N.lengthAttr(e,"after"),s=N.intAttr(e,"line",null),a=N.attr(e,"lineRule");if(r&&(t["margin-top"]=r),n&&(t["margin-bottom"]=n),null!==s)switch(a){case"auto":t["line-height"]=`${(s/240).toFixed(2)}`;break;case"atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;default:t["line-height"]=t["min-height"]=s/20+"pt"}}parseMarginProperties(e,t){He.foreach(e,e=>{switch(e.localName){case"left":t["padding-left"]=$e.valueOfMargin(e);break;case"right":t["padding-right"]=$e.valueOfMargin(e);break;case"top":t["padding-top"]=$e.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=$e.valueOfMargin(e)}})}parseTrHeight(e,t){N.attr(e,"hRule"),t.height=N.lengthAttr(e,"val")}parseBorderProperties(e,t){He.foreach(e,e=>{switch(e.localName){case"start":case"left":t["border-left"]=$e.valueOfBorder(e);break;case"end":case"right":t["border-right"]=$e.valueOfBorder(e);break;case"top":t["border-top"]=$e.valueOfBorder(e);break;case"bottom":t["border-bottom"]=$e.valueOfBorder(e)}})}}const Ve=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class He{static foreach(e,t){for(var r=0;r<e.childNodes.length;r++){let n=e.childNodes[r];n.nodeType==Node.ELEMENT_NODE&&t(n)}}static colorAttr(e,t,r=null,n="black"){var s=N.attr(e,t);if(s)return"auto"==s?n:Ve.includes(s)?s:`#${s}`;var a=N.attr(e,"themeColor");return a?`var(--docx-${a}-color)`:r}static sizeValue(e,t=h){return b(e.textContent,t)}}class $e{static themeValue(e,t){var r=N.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){var r=h;switch(N.attr(e,"type")){case"dxa":break;case"pct":r=g;break;case"auto":return"auto"}return N.lengthAttr(e,t,r)}static valueOfMargin(e){return N.lengthAttr(e,"w")}static valueOfBorder(e){var t=$e.parseBorderType(N.attr(e,"val"));if("none"==t)return"none";var r=He.colorAttr(e,"color");return`${N.lengthAttr(e,"sz",d)} ${t} ${"auto"==r?Le:r}`}static parseBorderType(e){switch(e){case"single":case"dashDotStroked":case"thick":case"thickThinLargeGap":case"thickThinMediumGap":case"thickThinSmallGap":case"thinThickLargeGap":case"thinThickMediumGap":case"thinThickSmallGap":case"thinThickThinLargeGap":case"thinThickThinMediumGap":case"thinThickThinSmallGap":case"threeDEmboss":case"threeDEngrave":case"wave":return"solid";case"dashed":case"dashSmallGap":return"dashed";case"dotDash":case"dotDotDash":case"dotted":return"dotted";case"double":case"doubleWave":case"triple":return"double";case"inset":return"inset";case"nil":case"none":return"none";case"outset":return"outset"}return"solid"}static valueOfTblLayout(e){return"fixed"==N.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){const t=N.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((e,r)=>"1"==t[r]).join(" ")}static valueOfJc(e){var t=N.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e,t=!1){var r=N.attr(e,"val");switch(r){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){var t=N.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){const t=N.hexAttr(e,"val",0);let r="";return(N.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),(N.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),(N.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),(N.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),(N.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),(N.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}}function Ue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var We,je,Ge,qe,ze,Xe,Ye,Je,Qe,Ke;function Ze(){return je?We:(je=1,We={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}function et(){return Xe||(Xe=1,ze=function(e,t={}){let r=/^(\w+):(.+)/.exec(e);return r&&t[r[1]]?{ns:t[r[1]],ln:r[2]}:{qn:e}}),ze}function tt(){if(Je)return Ye;Je=1;let e=et();return Ye=function(t,r={},n={}){return{el:(r,s={},a)=>{let o=e(r,n),i=o.ns?t.createElementNS(o.ns,r):t.createElement(r);return Object.keys(s).forEach(t=>{if(null==s[t]||""===s[t])return;let r=e(t,n);r.ns?i.setAttributeNS(r.ns,t,s[t]):i.setAttribute(t,s[t])}),a&&a.appendChild(i),i},amap:(t,s={})=>(Object.keys(r).forEach(a=>{let o=e(a,n);o.ns&&t.hasAttributeNS(o.ns,o.ln)?s[r[a]]=t.getAttributeNS(o.ns,o.ln):o.qn&&t.hasAttribute(a)&&(s[r[a]]=t.getAttribute(a))}),s)}}}var rt,nt={};var st,at={};function ot(){return st||(st=1,function(e){!function(e){function t(){this.init()}function r(e){this.expression=e}function n(){}function s(e){arguments.length>0&&this.init(e)}function a(e){arguments.length>0&&this.init(e)}function o(e,t){arguments.length>0&&this.init(e,t)}function i(e,t){arguments.length>0&&this.init(e,t)}function l(e,t){arguments.length>0&&this.init(e,t)}function c(e,t){arguments.length>0&&this.init(e,t)}function u(e,t){arguments.length>0&&this.init(e,t)}function h(e,t){arguments.length>0&&this.init(e,t)}function p(e,t){arguments.length>0&&this.init(e,t)}function m(e,t){arguments.length>0&&this.init(e,t)}function d(e,t){arguments.length>0&&this.init(e,t)}function f(e,t){arguments.length>0&&this.init(e,t)}function g(e,t){arguments.length>0&&this.init(e,t)}function b(e,t){arguments.length>0&&this.init(e,t)}function y(e,t){arguments.length>0&&this.init(e,t)}function v(e,t){arguments.length>0&&this.init(e,t)}function N(e,t){arguments.length>0&&this.init(e,t)}function E(e,t,r){arguments.length>0&&this.init(e,t,r)}function w(e){for(;e&&e.parentNode;)e=e.parentNode;return e}function S(e,t){arguments.length>0&&this.init(e,t)}function A(e,t,r){arguments.length>0&&this.init(e,t,r)}function k(e,t){arguments.length>0&&this.init(e,t)}function T(e){arguments.length>0&&this.init(e)}function C(e,t){arguments.length>0&&this.init(e,t)}function P(e){arguments.length>0&&this.init(e)}function x(e){arguments.length>0&&this.init(e)}function R(e){arguments.length>0&&this.init(e)}function D(e){this.init(e)}function M(){this.init()}function O(e,t,r){this.isXPathNamespace=!0,this.ownerDocument=r.ownerDocument,this.nodeName="#namespace",this.prefix=e,this.localName=e,this.namespaceURI=t,this.nodeValue=t,this.ownerElement=r,this.nodeType=O.XPATH_NAMESPACE_NODE}t.prototype=new Object,t.prototype.constructor=t,t.superclass=Object.prototype,t.prototype.init=function(){this.reduceActions=[],this.reduceActions[3]=function(e){return new i(e[0],e[2])},this.reduceActions[5]=function(e){return new l(e[0],e[2])},this.reduceActions[7]=function(e){return new c(e[0],e[2])},this.reduceActions[8]=function(e){return new u(e[0],e[2])},this.reduceActions[10]=function(e){return new h(e[0],e[2])},this.reduceActions[11]=function(e){return new p(e[0],e[2])},this.reduceActions[12]=function(e){return new m(e[0],e[2])},this.reduceActions[13]=function(e){return new d(e[0],e[2])},this.reduceActions[15]=function(e){return new f(e[0],e[2])},this.reduceActions[16]=function(e){return new g(e[0],e[2])},this.reduceActions[18]=function(e){return new b(e[0],e[2])},this.reduceActions[19]=function(e){return new y(e[0],e[2])},this.reduceActions[20]=function(e){return new v(e[0],e[2])},this.reduceActions[22]=function(e){return new a(e[1])},this.reduceActions[24]=function(e){return new N(e[0],e[2])},this.reduceActions[25]=function(e){return new E(void 0,void 0,e[0])},this.reduceActions[27]=function(e){return e[0].locationPath=e[2],e[0]},this.reduceActions[28]=function(e){return e[0].locationPath=e[2],e[0].locationPath.steps.unshift(new A(A.DESCENDANTORSELF,new k(k.NODE,void 0),[])),e[0]},this.reduceActions[29]=function(e){return new E(e[0],[],void 0)},this.reduceActions[30]=function(e){return H.instance_of(e[0],E)?(null==e[0].filterPredicates&&(e[0].filterPredicates=[]),e[0].filterPredicates.push(e[1]),e[0]):new E(e[0],[e[1]],void 0)},this.reduceActions[32]=function(e){return e[1]},this.reduceActions[33]=function(e){return new P(e[0])},this.reduceActions[34]=function(e){return new x(e[0])},this.reduceActions[36]=function(e){return new C(e[0],[])},this.reduceActions[37]=function(e){return new C(e[0],e[2])},this.reduceActions[38]=function(e){return[e[0]]},this.reduceActions[39]=function(e){return e[2].unshift(e[0]),e[2]},this.reduceActions[43]=function(e){return new S(!0,[])},this.reduceActions[44]=function(e){return e[1].absolute=!0,e[1]},this.reduceActions[46]=function(e){return new S(!1,[e[0]])},this.reduceActions[47]=function(e){return e[0].steps.push(e[2]),e[0]},this.reduceActions[49]=function(e){return new A(e[0],e[1],[])},this.reduceActions[50]=function(e){return new A(A.CHILD,e[0],[])},this.reduceActions[51]=function(e){return new A(e[0],e[1],e[2])},this.reduceActions[52]=function(e){return new A(A.CHILD,e[0],e[1])},this.reduceActions[54]=function(e){return[e[0]]},this.reduceActions[55]=function(e){return e[1].unshift(e[0]),e[1]},this.reduceActions[56]=function(e){return"ancestor"==e[0]?A.ANCESTOR:"ancestor-or-self"==e[0]?A.ANCESTORORSELF:"attribute"==e[0]?A.ATTRIBUTE:"child"==e[0]?A.CHILD:"descendant"==e[0]?A.DESCENDANT:"descendant-or-self"==e[0]?A.DESCENDANTORSELF:"following"==e[0]?A.FOLLOWING:"following-sibling"==e[0]?A.FOLLOWINGSIBLING:"namespace"==e[0]?A.NAMESPACE:"parent"==e[0]?A.PARENT:"preceding"==e[0]?A.PRECEDING:"preceding-sibling"==e[0]?A.PRECEDINGSIBLING:"self"==e[0]?A.SELF:-1},this.reduceActions[57]=function(e){return A.ATTRIBUTE},this.reduceActions[59]=function(e){return"comment"==e[0]?new k(k.COMMENT,void 0):"text"==e[0]?new k(k.TEXT,void 0):"processing-instruction"==e[0]?new k(k.PI,void 0):"node"==e[0]?new k(k.NODE,void 0):new k(-1,void 0)},this.reduceActions[60]=function(e){return new k(k.PI,e[2])},this.reduceActions[61]=function(e){return e[1]},this.reduceActions[63]=function(e){return e[1].absolute=!0,e[1].steps.unshift(new A(A.DESCENDANTORSELF,new k(k.NODE,void 0),[])),e[1]},this.reduceActions[64]=function(e){return e[0].steps.push(new A(A.DESCENDANTORSELF,new k(k.NODE,void 0),[])),e[0].steps.push(e[2]),e[0]},this.reduceActions[65]=function(e){return new A(A.SELF,new k(k.NODE,void 0),[])},this.reduceActions[66]=function(e){return new A(A.PARENT,new k(k.NODE,void 0),[])},this.reduceActions[67]=function(e){return new T(e[1])},this.reduceActions[68]=function(e){return new k(k.NAMETESTANY,void 0)},this.reduceActions[69]=function(e){var t=e[0].substring(0,e[0].indexOf(":"));return new k(k.NAMETESTPREFIXANY,t)},this.reduceActions[70]=function(e){return new k(k.NAMETESTQNAME,e[0])}},t.actionTable=[" s s        sssssssss    s ss  s  ss","                 s                  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                rrrrr               "," s s        sssssssss    s ss  s  ss","rs  rrrrrrrr s  sssssrrrrrr  rrs rs "," s s        sssssssss    s ss  s  ss","                            s       ","                            s       ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","  s                                 ","                            s       "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr  r  ","a                                   ","r       s                    rr  r  ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrs  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  srrrrrrrr         rrrrrrs rr sr  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                sssss               ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  srrrrrrrr         rrrrrrs rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","              s                     ","                             s      ","                rrrrr               "," s s        sssssssss    s sss s  ss","r  srrrrrrrr         rrrrrrs rr  r  "," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss      ss  s  ss"," s s        sssssssss    s ss  s  ss"," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr rr  "," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             rr     ","                             s      ","                             rs     ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","                                 r  ","                                 s  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  "," s s        sssssssss    s ss  s  ss","r  rrrrrrrrr         rrrrrrr rr rr  ","                             r      "],t.actionTableNumber=[" 1 0        /.-,+*)('    & %$  #  \"!","                 J                  ","a  aaaaaaaaa         aaaaaaa aa  a  ","                YYYYY               "," 1 0        /.-,+*)('    & %$  #  \"!","K1  KKKKKKKK .  +*)('KKKKKK  KK# K\" "," 1 0        /.-,+*)('    & %$  #  \"!","                            N       ","                            O       ","e  eeeeeeeee         eeeeeee ee ee  ","f  fffffffff         fffffff ff ff  ","d  ddddddddd         ddddddd dd dd  ","B  BBBBBBBBB         BBBBBBB BB BB  ","A  AAAAAAAAA         AAAAAAA AA AA  ","  P                                 ","                            Q       "," 1           .  +*)('          #  \" ","b  bbbbbbbbb         bbbbbbb bb  b  ","                                    ","!       S                    !!  !  ",'"      T"                    ""  "  ',"$   V  $$            U       $$  $  ","&   &ZY&&            &XW     &&  &  ",")   )))))            )))\\[   ))  )  ",".   ....._^]         .....   ..  .  ","1   11111111         11111   11  1  ","5   55555555         55555`  55  5  ","7   77777777         777777  77  7  ","9   99999999         999999  99  9  ",":  c::::::::         ::::::b :: a:  ","I  fIIIIIIII         IIIIIIe II  I  ","=  =========         ======= == ==  ","?  ?????????         ??????? ?? ??  ","C  CCCCCCCCC         CCCCCCC CC CC  ","J   JJJJJJJJ         JJJJJJ  JJ  J  ","M   MMMMMMMM         MMMMMM  MM  M  ","N  NNNNNNNNN         NNNNNNN NN  N  ","P  PPPPPPPPP         PPPPPPP PP  P  ","                +*)('               ","R  RRRRRRRRR         RRRRRRR RR aR  ","U  UUUUUUUUU         UUUUUUU UU  U  ","Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  ","c  ccccccccc         ccccccc cc cc  ","                             j      ","L  fLLLLLLLL         LLLLLLe LL  L  ","6   66666666         66666   66  6  ","              k                     ","                             l      ","                XXXXX               "," 1 0        /.-,+*)('    & %$m #  \"!","_  f________         ______e __  _  "," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('      %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ",">  >>>>>>>>>         >>>>>>> >> >>  "," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ","Q  QQQQQQQQQ         QQQQQQQ QQ aQ  ","V  VVVVVVVVV         VVVVVVV VV aV  ","T  TTTTTTTTT         TTTTTTT TT  T  ","@  @@@@@@@@@         @@@@@@@ @@ @@  ","                                   ","[  [[[[[[[[[         [[[[[[[ [[ [[  ","D  DDDDDDDDD         DDDDDDD DD DD  ","                             HH     ","                                   ","                             F     ","#      T#                    ##  #  ","%   V  %%            U       %%  %  ","'   'ZY''            'XW     ''  '  ","(   (ZY((            (XW     ((  (  ","+   +++++            +++\\[   ++  +  ","*   *****            ***\\[   **  *  ","-   -----            ---\\[   --  -  ",",   ,,,,,            ,,,\\[   ,,  ,  ","0   00000_^]         00000   00  0  ","/   /////_^]         /////   //  /  ","2   22222222         22222   22  2  ","3   33333333         33333   33  3  ","4   44444444         44444   44  4  ","8   88888888         888888  88  8  ","                                 ^  ","                                   ",";  f;;;;;;;;         ;;;;;;e ;;  ;  ","<  f<<<<<<<<         <<<<<<e <<  <  ","O  OOOOOOOOO         OOOOOOO OO  O  ","`  `````````         ``````` ``  `  ","S  SSSSSSSSS         SSSSSSS SS  S  ","W  WWWWWWWWW         WWWWWWW WW  W  ","\\  \\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\ \\\\ \\\\  ","E  EEEEEEEEE         EEEEEEE EE EE  "," 1 0        /.-,+*)('    & %$  #  \"!","]  ]]]]]]]]]         ]]]]]]] ]] ]]  ","                             G      "],t.gotoTable=["3456789:;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","L456789:;<=>?@ AB  CDEFGH IJ ","            M        EFGH IJ ","       N;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","            S        EFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              e              ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                        h  J ","              i          j   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABpqCDEFGH IJ ","                             ","  r6789:;<=>?@ AB  CDEFGH IJ ","   s789:;<=>?@ AB  CDEFGH IJ ","    t89:;<=>?@ AB  CDEFGH IJ ","    u89:;<=>?@ AB  CDEFGH IJ ","     v9:;<=>?@ AB  CDEFGH IJ ","     w9:;<=>?@ AB  CDEFGH IJ ","     x9:;<=>?@ AB  CDEFGH IJ ","     y9:;<=>?@ AB  CDEFGH IJ ","      z:;<=>?@ AB  CDEFGH IJ ","      {:;<=>?@ AB  CDEFGH IJ ","       |;<=>?@ AB  CDEFGH IJ ","       };<=>?@ AB  CDEFGH IJ ","       ~;<=>?@ AB  CDEFGH IJ ","         =>?@ AB  CDEFGH IJ ","456789:;<=>?@ AB  CDEFGH IJ","                    EFGH IJ ","                    EFGH IJ ","                             ","                      GH IJ ","                      GH IJ ","              i             ","              i             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABqCDEFGH IJ ","                             ","                             "],t.productions=[[1,1,2],[2,1,3],[3,1,4],[3,3,3,-9,4],[4,1,5],[4,3,4,-8,5],[5,1,6],[5,3,5,-22,6],[5,3,5,-5,6],[6,1,7],[6,3,6,-23,7],[6,3,6,-24,7],[6,3,6,-6,7],[6,3,6,-7,7],[7,1,8],[7,3,7,-25,8],[7,3,7,-26,8],[8,1,9],[8,3,8,-12,9],[8,3,8,-11,9],[8,3,8,-10,9],[9,1,10],[9,2,-26,9],[10,1,11],[10,3,10,-27,11],[11,1,12],[11,1,13],[11,3,13,-28,14],[11,3,13,-4,14],[13,1,15],[13,2,13,16],[15,1,17],[15,3,-29,2,-30],[15,1,-15],[15,1,-16],[15,1,18],[18,3,-13,-29,-30],[18,4,-13,-29,19,-30],[19,1,20],[19,3,20,-31,19],[20,1,2],[12,1,14],[12,1,21],[21,1,-28],[21,2,-28,14],[21,1,22],[14,1,23],[14,3,14,-28,23],[14,1,24],[23,2,25,26],[23,1,26],[23,3,25,26,27],[23,2,26,27],[23,1,28],[27,1,16],[27,2,16,27],[25,2,-14,-3],[25,1,-32],[26,1,29],[26,3,-20,-29,-30],[26,4,-21,-29,-15,-30],[16,3,-33,30,-34],[30,1,2],[22,2,-4,14],[24,3,14,-4,23],[28,1,-35],[28,1,-2],[17,2,-36,-18],[29,1,-17],[29,1,-19],[29,1,-18]],t.DOUBLEDOT=2,t.DOUBLECOLON=3,t.DOUBLESLASH=4,t.NOTEQUAL=5,t.LESSTHANOREQUAL=6,t.GREATERTHANOREQUAL=7,t.AND=8,t.OR=9,t.MOD=10,t.DIV=11,t.MULTIPLYOPERATOR=12,t.FUNCTIONNAME=13,t.AXISNAME=14,t.LITERAL=15,t.NUMBER=16,t.ASTERISKNAMETEST=17,t.QNAME=18,t.NCNAMECOLONASTERISK=19,t.NODETYPE=20,t.PROCESSINGINSTRUCTIONWITHLITERAL=21,t.EQUALS=22,t.LESSTHAN=23,t.GREATERTHAN=24,t.PLUS=25,t.MINUS=26,t.BAR=27,t.SLASH=28,t.LEFTPARENTHESIS=29,t.RIGHTPARENTHESIS=30,t.COMMA=31,t.AT=32,t.LEFTBRACKET=33,t.RIGHTBRACKET=34,t.DOT=35,t.DOLLAR=36,t.prototype.tokenize=function(e){for(var r=[],n=[],s=e+"\0",a=0,o=s.charAt(a++);;){for(;" "==o||"\t"==o||"\r"==o||"\n"==o;)o=s.charAt(a++);if("\0"==o||a>=s.length)break;if("("!=o)if(")"!=o)if("["!=o)if("]"!=o)if("@"!=o)if(","!=o)if("|"!=o)if("+"!=o)if("-"!=o)if("="!=o)if("$"!=o)if("."!=o)if("'"!=o&&'"'!=o)if(o>="0"&&o<="9"){h=o;for(o=s.charAt(a++);o>="0"&&o<="9";)h+=o,o=s.charAt(a++);if("."==o&&s.charAt(a)>="0"&&s.charAt(a)<="9")for(h+=o,h+=s.charAt(a++),o=s.charAt(a++);o>="0"&&o<="9";)h+=o,o=s.charAt(a++);r.push(t.NUMBER),n.push(h)}else if("*"!=o)if(":"!=o||":"!=s.charAt(a))if("/"!=o)if("!"!=o||"="!=s.charAt(a))if("<"!=o)if(">"!=o){if("_"!=o&&!H.isLetter(o.charCodeAt(0)))throw new Error("Unexpected character "+o);var i=o;for(o=s.charAt(a++);H.isNCNameChar(o.charCodeAt(0));)i+=o,o=s.charAt(a++);if(r.length>0&&(l=r[r.length-1])!=t.AT&&l!=t.DOUBLECOLON&&l!=t.LEFTPARENTHESIS&&l!=t.LEFTBRACKET&&l!=t.AND&&l!=t.OR&&l!=t.MOD&&l!=t.DIV&&l!=t.MULTIPLYOPERATOR&&l!=t.SLASH&&l!=t.DOUBLESLASH&&l!=t.BAR&&l!=t.PLUS&&l!=t.MINUS&&l!=t.EQUALS&&l!=t.NOTEQUAL&&l!=t.LESSTHAN&&l!=t.LESSTHANOREQUAL&&l!=t.GREATERTHAN&&l!=t.GREATERTHANOREQUAL){if("and"==i){r.push(t.AND),n.push(i);continue}if("or"==i){r.push(t.OR),n.push(i);continue}if("mod"==i){r.push(t.MOD),n.push(i);continue}if("div"==i){r.push(t.DIV),n.push(i);continue}}if(":"==o){if("*"==s.charAt(a)){r.push(t.NCNAMECOLONASTERISK),n.push(i+":*"),a++,o=s.charAt(a++);continue}if("_"==s.charAt(a)||H.isLetter(s.charCodeAt(a))){for(i+=":",o=s.charAt(a++);H.isNCNameChar(o.charCodeAt(0));)i+=o,o=s.charAt(a++);if("("==o){r.push(t.FUNCTIONNAME),n.push(i);continue}r.push(t.QNAME),n.push(i);continue}if(":"==s.charAt(a)){r.push(t.AXISNAME),n.push(i);continue}}if("("==o){if("comment"==i||"text"==i||"node"==i){r.push(t.NODETYPE),n.push(i);continue}if("processing-instruction"==i){")"==s.charAt(a)?r.push(t.NODETYPE):r.push(t.PROCESSINGINSTRUCTIONWITHLITERAL),n.push(i);continue}r.push(t.FUNCTIONNAME),n.push(i);continue}r.push(t.QNAME),n.push(i)}else{if("="==s.charAt(a)){r.push(t.GREATERTHANOREQUAL),n.push(">="),a++,o=s.charAt(a++);continue}r.push(t.GREATERTHAN),n.push(">"),o=s.charAt(a++)}else{if("="==s.charAt(a)){r.push(t.LESSTHANOREQUAL),n.push("<="),a++,o=s.charAt(a++);continue}r.push(t.LESSTHAN),n.push("<"),o=s.charAt(a++)}else r.push(t.NOTEQUAL),n.push("!="),a++,o=s.charAt(a++);else{if("/"==(o=s.charAt(a++))){r.push(t.DOUBLESLASH),n.push("//"),o=s.charAt(a++);continue}r.push(t.SLASH),n.push("/")}else r.push(t.DOUBLECOLON),n.push("::"),a++,o=s.charAt(a++);else{var l;if(r.length>0&&(l=r[r.length-1])!=t.AT&&l!=t.DOUBLECOLON&&l!=t.LEFTPARENTHESIS&&l!=t.LEFTBRACKET&&l!=t.AND&&l!=t.OR&&l!=t.MOD&&l!=t.DIV&&l!=t.MULTIPLYOPERATOR&&l!=t.SLASH&&l!=t.DOUBLESLASH&&l!=t.BAR&&l!=t.PLUS&&l!=t.MINUS&&l!=t.EQUALS&&l!=t.NOTEQUAL&&l!=t.LESSTHAN&&l!=t.LESSTHANOREQUAL&&l!=t.GREATERTHAN&&l!=t.GREATERTHANOREQUAL){r.push(t.MULTIPLYOPERATOR),n.push(o),o=s.charAt(a++);continue}r.push(t.ASTERISKNAMETEST),n.push(o),o=s.charAt(a++)}else{for(var c=o,u="";a<s.length&&(o=s.charAt(a))!==c;)u+=o,a+=1;if(o!==c)throw $.fromMessage("Unterminated string literal: "+c+u);a+=1,r.push(t.LITERAL),n.push(u),o=s.charAt(a++)}else{if("."==(o=s.charAt(a++))){r.push(t.DOUBLEDOT),n.push(".."),o=s.charAt(a++);continue}if(o>="0"&&o<="9"){var h="."+o;for(o=s.charAt(a++);o>="0"&&o<="9";)h+=o,o=s.charAt(a++);r.push(t.NUMBER),n.push(h);continue}r.push(t.DOT),n.push(".")}else r.push(t.DOLLAR),n.push(o),o=s.charAt(a++);else r.push(t.EQUALS),n.push(o),o=s.charAt(a++);else r.push(t.MINUS),n.push(o),o=s.charAt(a++);else r.push(t.PLUS),n.push(o),o=s.charAt(a++);else r.push(t.BAR),n.push(o),o=s.charAt(a++);else r.push(t.COMMA),n.push(o),o=s.charAt(a++);else r.push(t.AT),n.push(o),o=s.charAt(a++);else r.push(t.RIGHTBRACKET),n.push(o),o=s.charAt(a++);else r.push(t.LEFTBRACKET),n.push(o),o=s.charAt(a++);else r.push(t.RIGHTPARENTHESIS),n.push(o),o=s.charAt(a++);else r.push(t.LEFTPARENTHESIS),n.push(o),o=s.charAt(a++)}return r.push(1),n.push("[EOF]"),[r,n]},t.SHIFT="s",t.REDUCE="r",t.ACCEPT="a",t.prototype.parse=function(e){var n,s,a=this.tokenize(e);if(null!=a){n=a[0],s=a[1];var o,i,l=0,c=[],u=[],h=[];for(c.push(0),u.push(1),h.push("_S"),o=n[l],i=s[l++];;)switch(e=c[c.length-1],t.actionTable[e].charAt(o-1)){case t.SHIFT:u.push(-o),h.push(i),c.push(t.actionTableNumber[e].charCodeAt(o-1)-32),o=n[l],i=s[l++];break;case t.REDUCE:for(var p=t.productions[t.actionTableNumber[e].charCodeAt(o-1)-32][1],m=[],d=0;d<p;d++)u.pop(),m.unshift(h.pop()),c.pop();var f=c[c.length-1];u.push(t.productions[t.actionTableNumber[e].charCodeAt(o-1)-32][0]),null==this.reduceActions[t.actionTableNumber[e].charCodeAt(o-1)-32]?h.push(m[0]):h.push(this.reduceActions[t.actionTableNumber[e].charCodeAt(o-1)-32](m)),c.push(t.gotoTable[f].charCodeAt(t.productions[t.actionTableNumber[e].charCodeAt(o-1)-32][0]-2)-33);break;case t.ACCEPT:return new r(h.pop());default:throw new Error("XPath parse error")}}},r.prototype=new Object,r.prototype.constructor=r,r.superclass=Object.prototype,r.prototype.toString=function(){return this.expression.toString()},r.prototype.evaluate=function(e){if(e.contextNode=e.expressionContextNode,e.contextSize=1,e.contextPosition=1,e.caseInsensitive=!1,null!=e.contextNode){var t=e.contextNode;9!=t.nodeType&&(t=t.ownerDocument);try{e.caseInsensitive=t.implementation.hasFeature("HTML","2.0")}catch(t){e.caseInsensitive=!0}}return this.expression.evaluate(e)},r.XML_NAMESPACE_URI="http://www.w3.org/XML/1998/namespace",r.XMLNS_NAMESPACE_URI="http://www.w3.org/2000/xmlns/",n.prototype=new Object,n.prototype.constructor=n,n.superclass=Object.prototype,n.prototype.init=function(){},n.prototype.toString=function(){return"<Expression>"},n.prototype.evaluate=function(e){throw new Error("Could not evaluate expression.")},s.prototype=new n,s.prototype.constructor=s,s.superclass=n.prototype,s.prototype.init=function(e){this.rhs=e},a.prototype=new s,a.prototype.constructor=a,a.superclass=s.prototype,a.prototype.init=function(e){a.superclass.init.call(this,e)},a.prototype.evaluate=function(e){return this.rhs.evaluate(e).number().negate()},a.prototype.toString=function(){return"-"+this.rhs.toString()},o.prototype=new n,o.prototype.constructor=o,o.superclass=n.prototype,o.prototype.init=function(e,t){this.lhs=e,this.rhs=t},i.prototype=new o,i.prototype.constructor=i,i.superclass=o.prototype,i.prototype.init=function(e,t){i.superclass.init.call(this,e,t)},i.prototype.toString=function(){return"("+this.lhs.toString()+" or "+this.rhs.toString()+")"},i.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?t:this.rhs.evaluate(e).bool()},l.prototype=new o,l.prototype.constructor=l,l.superclass=o.prototype,l.prototype.init=function(e,t){l.superclass.init.call(this,e,t)},l.prototype.toString=function(){return"("+this.lhs.toString()+" and "+this.rhs.toString()+")"},l.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?this.rhs.evaluate(e).bool():t},c.prototype=new o,c.prototype.constructor=c,c.superclass=o.prototype,c.prototype.init=function(e,t){c.superclass.init.call(this,e,t)},c.prototype.toString=function(){return"("+this.lhs.toString()+" = "+this.rhs.toString()+")"},c.prototype.evaluate=function(e){return this.lhs.evaluate(e).equals(this.rhs.evaluate(e))},u.prototype=new o,u.prototype.constructor=u,u.superclass=o.prototype,u.prototype.init=function(e,t){u.superclass.init.call(this,e,t)},u.prototype.toString=function(){return"("+this.lhs.toString()+" != "+this.rhs.toString()+")"},u.prototype.evaluate=function(e){return this.lhs.evaluate(e).notequal(this.rhs.evaluate(e))},h.prototype=new o,h.prototype.constructor=h,h.superclass=o.prototype,h.prototype.init=function(e,t){h.superclass.init.call(this,e,t)},h.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthan(this.rhs.evaluate(e))},h.prototype.toString=function(){return"("+this.lhs.toString()+" < "+this.rhs.toString()+")"},p.prototype=new o,p.prototype.constructor=p,p.superclass=o.prototype,p.prototype.init=function(e,t){p.superclass.init.call(this,e,t)},p.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthan(this.rhs.evaluate(e))},p.prototype.toString=function(){return"("+this.lhs.toString()+" > "+this.rhs.toString()+")"},m.prototype=new o,m.prototype.constructor=m,m.superclass=o.prototype,m.prototype.init=function(e,t){m.superclass.init.call(this,e,t)},m.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthanorequal(this.rhs.evaluate(e))},m.prototype.toString=function(){return"("+this.lhs.toString()+" <= "+this.rhs.toString()+")"},d.prototype=new o,d.prototype.constructor=d,d.superclass=o.prototype,d.prototype.init=function(e,t){d.superclass.init.call(this,e,t)},d.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthanorequal(this.rhs.evaluate(e))},d.prototype.toString=function(){return"("+this.lhs.toString()+" >= "+this.rhs.toString()+")"},f.prototype=new o,f.prototype.constructor=f,f.superclass=o.prototype,f.prototype.init=function(e,t){f.superclass.init.call(this,e,t)},f.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().plus(this.rhs.evaluate(e).number())},f.prototype.toString=function(){return"("+this.lhs.toString()+" + "+this.rhs.toString()+")"},g.prototype=new o,g.prototype.constructor=g,g.superclass=o.prototype,g.prototype.init=function(e,t){g.superclass.init.call(this,e,t)},g.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().minus(this.rhs.evaluate(e).number())},g.prototype.toString=function(){return"("+this.lhs.toString()+" - "+this.rhs.toString()+")"},b.prototype=new o,b.prototype.constructor=b,b.superclass=o.prototype,b.prototype.init=function(e,t){b.superclass.init.call(this,e,t)},b.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().multiply(this.rhs.evaluate(e).number())},b.prototype.toString=function(){return"("+this.lhs.toString()+" * "+this.rhs.toString()+")"},y.prototype=new o,y.prototype.constructor=y,y.superclass=o.prototype,y.prototype.init=function(e,t){y.superclass.init.call(this,e,t)},y.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().div(this.rhs.evaluate(e).number())},y.prototype.toString=function(){return"("+this.lhs.toString()+" div "+this.rhs.toString()+")"},v.prototype=new o,v.prototype.constructor=v,v.superclass=o.prototype,v.prototype.init=function(e,t){v.superclass.init.call(this,e,t)},v.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().mod(this.rhs.evaluate(e).number())},v.prototype.toString=function(){return"("+this.lhs.toString()+" mod "+this.rhs.toString()+")"},N.prototype=new o,N.prototype.constructor=N,N.superclass=o.prototype,N.prototype.init=function(e,t){N.superclass.init.call(this,e,t)},N.prototype.evaluate=function(e){return this.lhs.evaluate(e).nodeset().union(this.rhs.evaluate(e).nodeset())},N.prototype.toString=function(){return this.lhs.toString()+" | "+this.rhs.toString()},E.prototype=new n,E.prototype.constructor=E,E.superclass=n.prototype,E.prototype.init=function(e,t,r){E.superclass.init.call(this),this.filter=e,this.filterPredicates=t,this.locationPath=r},E.prototype.evaluate=function(e){var t,n=new _;if(n.variableResolver=e.variableResolver,n.functionResolver=e.functionResolver,n.namespaceResolver=e.namespaceResolver,n.expressionContextNode=e.expressionContextNode,n.virtualRoot=e.virtualRoot,n.caseInsensitive=e.caseInsensitive,null==this.filter)t=[e.contextNode];else{var s=this.filter.evaluate(e);if(!H.instance_of(s,M)){if(null!=this.filterPredicates&&this.filterPredicates.length>0||null!=this.locationPath)throw new Error("Path expression filter must evaluate to a nodset if predicates or location path are used");return s}if(t=s.toUnsortedArray(),null!=this.filterPredicates)for(var a=0;a<this.filterPredicates.length;a++){var o=this.filterPredicates[a],i=[];for(n.contextSize=t.length,n.contextPosition=1;n.contextPosition<=n.contextSize;n.contextPosition++)n.contextNode=t[n.contextPosition-1],this.predicateMatches(o,n)&&i.push(n.contextNode);t=i}}if(null!=this.locationPath){if(this.locationPath.absolute)if(9!=t[0].nodeType)if(null!=n.virtualRoot)t=[n.virtualRoot];else if(null==t[0].ownerDocument){for(var l=t[0];null!=l.parentNode;)l=l.parentNode;t=[l]}else t=[t[0].ownerDocument];else t=[t[0]];for(var c=0;c<this.locationPath.steps.length;c++){var u=this.locationPath.steps[c];for(i=[],a=0;a<t.length;a++)switch(n.contextNode=t[a],u.axis){case A.ANCESTOR:if(n.contextNode===n.virtualRoot)break;for(h=2==n.contextNode.nodeType?this.getOwnerElement(n.contextNode):n.contextNode.parentNode;null!=h&&(u.nodeTest.matches(h,n)&&i.push(h),h!==n.virtualRoot);)h=h.parentNode;break;case A.ANCESTORORSELF:for(var h=n.contextNode;null!=h&&(u.nodeTest.matches(h,n)&&i.push(h),h!==n.virtualRoot);h=2==h.nodeType?this.getOwnerElement(h):h.parentNode);break;case A.ATTRIBUTE:var p=n.contextNode.attributes;if(null!=p)for(var m=0;m<p.length;m++){h=p.item(m);u.nodeTest.matches(h,n)&&i.push(h)}break;case A.CHILD:for(h=n.contextNode.firstChild;null!=h;h=h.nextSibling)u.nodeTest.matches(h,n)&&i.push(h);break;case A.DESCENDANT:for(var d=[n.contextNode.firstChild];d.length>0;)for(h=d.pop();null!=h;)u.nodeTest.matches(h,n)&&i.push(h),null!=h.firstChild?(d.push(h.nextSibling),h=h.firstChild):h=h.nextSibling;break;case A.DESCENDANTORSELF:u.nodeTest.matches(n.contextNode,n)&&i.push(n.contextNode);for(d=[n.contextNode.firstChild];d.length>0;)for(h=d.pop();null!=h;)u.nodeTest.matches(h,n)&&i.push(h),null!=h.firstChild?(d.push(h.nextSibling),h=h.firstChild):h=h.nextSibling;break;case A.FOLLOWING:if(n.contextNode===n.virtualRoot)break;d=[];null!=n.contextNode.firstChild?d.unshift(n.contextNode.firstChild):d.unshift(n.contextNode.nextSibling);for(h=n.contextNode.parentNode;null!=h&&9!=h.nodeType&&h!==n.virtualRoot;h=h.parentNode)d.unshift(h.nextSibling);do{for(h=d.pop();null!=h;)u.nodeTest.matches(h,n)&&i.push(h),null!=h.firstChild?(d.push(h.nextSibling),h=h.firstChild):h=h.nextSibling}while(d.length>0);break;case A.FOLLOWINGSIBLING:if(n.contextNode===n.virtualRoot)break;for(h=n.contextNode.nextSibling;null!=h;h=h.nextSibling)u.nodeTest.matches(h,n)&&i.push(h);break;case A.NAMESPACE:l={};if(1==n.contextNode.nodeType){l.xml=r.XML_NAMESPACE_URI,l.xmlns=r.XMLNS_NAMESPACE_URI;for(h=n.contextNode;null!=h&&1==h.nodeType;h=h.parentNode)for(m=0;m<h.attributes.length;m++){var f=h.attributes.item(m),g=String(f.name);if("xmlns"==g)null==l[""]&&(l[""]=f.value);else if(g.length>6&&"xmlns:"==g.substring(0,6)){null==l[b=g.substring(6,g.length)]&&(l[b]=f.value)}}for(var b in l){var y=new O(b,l[b],n.contextNode);u.nodeTest.matches(y,n)&&i.push(y)}}break;case A.PARENT:h=null,n.contextNode!==n.virtualRoot&&(h=2==n.contextNode.nodeType?this.getOwnerElement(n.contextNode):n.contextNode.parentNode),null!=h&&u.nodeTest.matches(h,n)&&i.push(h);break;case A.PRECEDING:d=null!=n.virtualRoot?[n.virtualRoot]:[w(n.contextNode)];e:for(;d.length>0;)for(h=d.pop();null!=h;){if(h==n.contextNode)break e;u.nodeTest.matches(h,n)&&i.unshift(h),null!=h.firstChild?(d.push(h.nextSibling),h=h.firstChild):h=h.nextSibling}break;case A.PRECEDINGSIBLING:if(n.contextNode===n.virtualRoot)break;for(h=n.contextNode.previousSibling;null!=h;h=h.previousSibling)u.nodeTest.matches(h,n)&&i.push(h);break;case A.SELF:u.nodeTest.matches(n.contextNode,n)&&i.push(n.contextNode)}t=i;for(a=0;a<u.predicates.length;a++){o=u.predicates[a],i=[];for(n.contextSize=t.length,n.contextPosition=1;n.contextPosition<=n.contextSize;n.contextPosition++)n.contextNode=t[n.contextPosition-1],this.predicateMatches(o,n)&&i.push(n.contextNode);t=i}}}return(s=new M).addArray(t),s},E.prototype.predicateMatches=function(e,t){var r=e.evaluate(t);return H.instance_of(r,x)?t.contextPosition==r.numberValue():r.booleanValue()},E.prototype.toString=function(){if(null!=this.filter){var e=this.filter.toString();if(H.instance_of(this.filter,P)&&(e="'"+e+"'"),null!=this.filterPredicates)for(var t=0;t<this.filterPredicates.length;t++)e=e+"["+this.filterPredicates[t].toString()+"]";return null!=this.locationPath&&(this.locationPath.absolute||(e+="/"),e+=this.locationPath.toString()),e}return this.locationPath.toString()},E.prototype.getOwnerElement=function(e){if(e.ownerElement)return e.ownerElement;try{if(e.selectSingleNode)return e.selectSingleNode("..")}catch(e){}for(var t=(9==e.nodeType?e:e.ownerDocument).getElementsByTagName("*"),r=0;r<t.length;r++)for(var n=t.item(r),s=n.attributes,a=0;a<s.length;a++){if(s.item(a)===e)return n}return null},S.prototype=new Object,S.prototype.constructor=S,S.superclass=Object.prototype,S.prototype.init=function(e,t){this.absolute=e,this.steps=t},S.prototype.toString=function(){var e;e=this.absolute?"/":"";for(var t=0;t<this.steps.length;t++)0!=t&&(e+="/"),e+=this.steps[t].toString();return e},A.prototype=new Object,A.prototype.constructor=A,A.superclass=Object.prototype,A.prototype.init=function(e,t,r){this.axis=e,this.nodeTest=t,this.predicates=r},A.prototype.toString=function(){var e;switch(this.axis){case A.ANCESTOR:e="ancestor";break;case A.ANCESTORORSELF:e="ancestor-or-self";break;case A.ATTRIBUTE:e="attribute";break;case A.CHILD:e="child";break;case A.DESCENDANT:e="descendant";break;case A.DESCENDANTORSELF:e="descendant-or-self";break;case A.FOLLOWING:e="following";break;case A.FOLLOWINGSIBLING:e="following-sibling";break;case A.NAMESPACE:e="namespace";break;case A.PARENT:e="parent";break;case A.PRECEDING:e="preceding";break;case A.PRECEDINGSIBLING:e="preceding-sibling";break;case A.SELF:e="self"}e+="::",e+=this.nodeTest.toString();for(var t=0;t<this.predicates.length;t++)e+="["+this.predicates[t].toString()+"]";return e},A.ANCESTOR=0,A.ANCESTORORSELF=1,A.ATTRIBUTE=2,A.CHILD=3,A.DESCENDANT=4,A.DESCENDANTORSELF=5,A.FOLLOWING=6,A.FOLLOWINGSIBLING=7,A.NAMESPACE=8,A.PARENT=9,A.PRECEDING=10,A.PRECEDINGSIBLING=11,A.SELF=12,k.prototype=new Object,k.prototype.constructor=k,k.superclass=Object.prototype,k.prototype.init=function(e,t){this.type=e,this.value=t},k.prototype.toString=function(){switch(this.type){case k.NAMETESTANY:return"*";case k.NAMETESTPREFIXANY:return this.value+":*";case k.NAMETESTRESOLVEDANY:return"{"+this.value+"}*";case k.NAMETESTQNAME:return this.value;case k.NAMETESTRESOLVEDNAME:return"{"+this.namespaceURI+"}"+this.value;case k.COMMENT:return"comment()";case k.TEXT:return"text()";case k.PI:return null!=this.value?'processing-instruction("'+this.value+'")':"processing-instruction()";case k.NODE:return"node()"}return"<unknown nodetest type>"},k.prototype.matches=function(e,t){var r=e.nodeType;switch(this.type){case k.NAMETESTANY:return 2===r||1===r||r===O.XPATH_NAMESPACE_NODE;case k.NAMETESTPREFIXANY:if(2===r||1===r){var n=t.namespaceResolver.getNamespace(this.value,t.expressionContextNode);if(null==n)throw new Error("Cannot resolve QName "+this.value);return n===(e.namespaceURI||"")}return!1;case k.NAMETESTQNAME:if(2===r||1===r||r===O.XPATH_NAMESPACE_NODE){var s=H.resolveQName(this.value,t.namespaceResolver,t.expressionContextNode,!1);if(null==s[0])throw new Error("Cannot resolve QName "+this.value);s[0]=String(s[0])||null,s[1]=String(s[1]);var a=[String(e.namespaceURI||"")||null,String(e.localName||e.nodeName)];return t.caseInsensitive?s[0]===a[0]&&s[1].toLowerCase()===a[1].toLowerCase():s[0]===a[0]&&s[1]===a[1]}return!1;case k.COMMENT:return 8===r;case k.TEXT:return 3===r||4==r;case k.PI:return 7===r&&(null==this.value||e.nodeName==this.value);case k.NODE:return 9===r||1===r||2===r||3===r||4===r||8===r||7===r}return!1},k.NAMETESTANY=0,k.NAMETESTPREFIXANY=1,k.NAMETESTQNAME=2,k.COMMENT=3,k.TEXT=4,k.PI=5,k.NODE=6,T.prototype=new n,T.prototype.constructor=T,T.superclass=n.prototype,T.prototype.init=function(e){this.variable=e},T.prototype.toString=function(){return"$"+this.variable},T.prototype.evaluate=function(e){var t=H.resolveQName(this.variable,e.namespaceResolver,e.contextNode,!1);if(null==t[0])throw new Error("Cannot resolve QName "+fn);var r=e.variableResolver.getVariable(t[1],t[0]);if(!r)throw $.fromMessage("Undeclared variable: "+this.toString());return r},C.prototype=new n,C.prototype.constructor=C,C.superclass=n.prototype,C.prototype.init=function(e,t){this.functionName=e,this.arguments=t},C.prototype.toString=function(){for(var e=this.functionName+"(",t=0;t<this.arguments.length;t++)t>0&&(e+=", "),e+=this.arguments[t].toString();return e+")"},C.prototype.evaluate=function(e){var t=B.getFunctionFromContext(this.functionName,e);if(!t)throw new Error("Unknown function "+this.functionName);var r=[e].concat(this.arguments);return t.apply(e.functionResolver.thisArg,r)},P.prototype=new n,P.prototype.constructor=P,P.superclass=n.prototype,P.prototype.init=function(e){this.str=String(e)},P.prototype.toString=function(){return this.str},P.prototype.evaluate=function(e){return this},P.prototype.string=function(){return this},P.prototype.number=function(){return new x(this.str)},P.prototype.bool=function(){return new R(this.str)},P.prototype.nodeset=function(){throw new Error("Cannot convert string to nodeset")},P.prototype.stringValue=function(){return this.str},P.prototype.numberValue=function(){return this.number().numberValue()},P.prototype.booleanValue=function(){return this.bool().booleanValue()},P.prototype.equals=function(e){return H.instance_of(e,R)?this.bool().equals(e):H.instance_of(e,x)?this.number().equals(e):H.instance_of(e,M)?e.compareWithString(this,L.equals):new R(this.str==e.str)},P.prototype.notequal=function(e){return H.instance_of(e,R)?this.bool().notequal(e):H.instance_of(e,x)?this.number().notequal(e):H.instance_of(e,M)?e.compareWithString(this,L.notequal):new R(this.str!=e.str)},P.prototype.lessthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.greaterthanorequal):this.number().lessthan(e.number())},P.prototype.greaterthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.lessthanorequal):this.number().greaterthan(e.number())},P.prototype.lessthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.greaterthan):this.number().lessthanorequal(e.number())},P.prototype.greaterthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.lessthan):this.number().greaterthanorequal(e.number())},x.prototype=new n,x.prototype.constructor=x,x.superclass=n.prototype,x.prototype.init=function(e){this.num="string"==typeof e?this.parse(e):Number(e)},x.prototype.numberFormat=/^\s*-?[0-9]*\.?[0-9]+\s*$/,x.prototype.parse=function(e){return this.numberFormat.test(e)?parseFloat(e):Number.NaN},x.prototype.toString=function(){var e=this.num.toString();return-1!==e.indexOf("e-")?function(e){for(var t=e.split("e-"),r=t[0].replace(".",""),n=Number(t[1]),s=0;s<n-1;s+=1)r="0"+r;return"0."+r}(e):-1!==e.indexOf("e")?function(e){for(var t=e.split("e"),r=t[0].replace(".",""),n=Number(t[1])+1-r.length,s=0;s<n;s+=1)r+="0";return r}(e):e},x.prototype.evaluate=function(e){return this},x.prototype.string=function(){return new P(this.toString())},x.prototype.number=function(){return this},x.prototype.bool=function(){return new R(this.num)},x.prototype.nodeset=function(){throw new Error("Cannot convert number to nodeset")},x.prototype.stringValue=function(){return this.string().stringValue()},x.prototype.numberValue=function(){return this.num},x.prototype.booleanValue=function(){return this.bool().booleanValue()},x.prototype.negate=function(){return new x(-this.num)},x.prototype.equals=function(e){return H.instance_of(e,R)?this.bool().equals(e):H.instance_of(e,P)?this.equals(e.number()):H.instance_of(e,M)?e.compareWithNumber(this,L.equals):new R(this.num==e.num)},x.prototype.notequal=function(e){return H.instance_of(e,R)?this.bool().notequal(e):H.instance_of(e,P)?this.notequal(e.number()):H.instance_of(e,M)?e.compareWithNumber(this,L.notequal):new R(this.num!=e.num)},x.prototype.lessthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this,L.greaterthanorequal):H.instance_of(e,R)||H.instance_of(e,P)?this.lessthan(e.number()):new R(this.num<e.num)},x.prototype.greaterthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this,L.lessthanorequal):H.instance_of(e,R)||H.instance_of(e,P)?this.greaterthan(e.number()):new R(this.num>e.num)},x.prototype.lessthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this,L.greaterthan):H.instance_of(e,R)||H.instance_of(e,P)?this.lessthanorequal(e.number()):new R(this.num<=e.num)},x.prototype.greaterthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this,L.lessthan):H.instance_of(e,R)||H.instance_of(e,P)?this.greaterthanorequal(e.number()):new R(this.num>=e.num)},x.prototype.plus=function(e){return new x(this.num+e.num)},x.prototype.minus=function(e){return new x(this.num-e.num)},x.prototype.multiply=function(e){return new x(this.num*e.num)},x.prototype.div=function(e){return new x(this.num/e.num)},x.prototype.mod=function(e){return new x(this.num%e.num)},R.prototype=new n,R.prototype.constructor=R,R.superclass=n.prototype,R.prototype.init=function(e){this.b=Boolean(e)},R.prototype.toString=function(){return this.b.toString()},R.prototype.evaluate=function(e){return this},R.prototype.string=function(){return new P(this.b)},R.prototype.number=function(){return new x(this.b)},R.prototype.bool=function(){return this},R.prototype.nodeset=function(){throw new Error("Cannot convert boolean to nodeset")},R.prototype.stringValue=function(){return this.string().stringValue()},R.prototype.numberValue=function(){return this.num().numberValue()},R.prototype.booleanValue=function(){return this.b},R.prototype.not=function(){return new R(!this.b)},R.prototype.equals=function(e){return H.instance_of(e,P)||H.instance_of(e,x)?this.equals(e.bool()):H.instance_of(e,M)?e.compareWithBoolean(this,L.equals):new R(this.b==e.b)},R.prototype.notequal=function(e){return H.instance_of(e,P)||H.instance_of(e,x)?this.notequal(e.bool()):H.instance_of(e,M)?e.compareWithBoolean(this,L.notequal):new R(this.b!=e.b)},R.prototype.lessthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.greaterthanorequal):this.number().lessthan(e.number())},R.prototype.greaterthan=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.lessthanorequal):this.number().greaterthan(e.number())},R.prototype.lessthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.greaterthan):this.number().lessthanorequal(e.number())},R.prototype.greaterthanorequal=function(e){return H.instance_of(e,M)?e.compareWithNumber(this.number(),L.lessthan):this.number().greaterthanorequal(e.number())},D.prototype=new Object,D.prototype.constructor=D,D.superclass=Object.prototype,D.prototype.init=function(e){this.left=null,this.right=null,this.node=e,this.depth=1},D.prototype.balance=function(){var e=null==this.left?0:this.left.depth,t=null==this.right?0:this.right.depth;if(e>t+1)(null==this.left.left?0:this.left.left.depth)<(null==this.left.right?0:this.left.right.depth)&&this.left.rotateRR(),this.rotateLL();else if(e+1<t){var r=null==this.right.right?0:this.right.right.depth;(null==this.right.left?0:this.right.left.depth)>r&&this.right.rotateLL(),this.rotateRR()}},D.prototype.rotateLL=function(){var e=this.node,t=this.right;this.node=this.left.node,this.right=this.left,this.left=this.left.left,this.right.left=this.right.right,this.right.right=t,this.right.node=e,this.right.updateInNewLocation(),this.updateInNewLocation()},D.prototype.rotateRR=function(){var e=this.node,t=this.left;this.node=this.right.node,this.left=this.right,this.right=this.right.right,this.left.right=this.left.left,this.left.left=t,this.left.node=e,this.left.updateInNewLocation(),this.updateInNewLocation()},D.prototype.updateInNewLocation=function(){this.getDepthFromChildren()},D.prototype.getDepthFromChildren=function(){this.depth=null==this.node?0:1,null!=this.left&&(this.depth=this.left.depth+1),null!=this.right&&this.depth<=this.right.depth&&(this.depth=this.right.depth+1)},D.prototype.add=function(e){if(e===this.node)return!1;var t=function(e,t){if(e===t)return 0;if(e.compareDocumentPosition){var r=e.compareDocumentPosition(t);return 1&r||10&r?1:20&r?-1:0}for(var n=0,s=0,a=e;null!=a;a=a.parentNode||a.ownerElement)n++;for(var o=t;null!=o;o=o.parentNode||o.ownerElement)s++;if(n>s){for(;n>s;)e=e.parentNode||e.ownerElement,n--;if(e===t)return 1}else if(s>n){for(;s>n;)t=t.parentNode||t.ownerElement,s--;if(e===t)return-1}for(var i=e.parentNode||e.ownerElement,l=t.parentNode||t.ownerElement;i!==l;)t=l,i=(e=i).parentNode||e.ownerElement,l=t.parentNode||t.ownerElement;var c=H.isAttribute(e),u=H.isAttribute(t);if(c&&!u)return-1;if(!c&&u)return 1;if(i)for(var h=c?i.attributes:i.childNodes,p=h.length,m=0;m<p;m+=1){var d=h[m];if(d===e)return-1;if(d===t)return 1}throw new Error("Unexpected: could not determine node order")}(e,this.node),r=!1;return-1==t?null==this.left?(this.left=new D(e),r=!0):(r=this.left.add(e))&&this.balance():1==t&&(null==this.right?(this.right=new D(e),r=!0):(r=this.right.add(e))&&this.balance()),r&&this.getDepthFromChildren(),r},M.prototype=new n,M.prototype.constructor=M,M.superclass=n.prototype,M.prototype.init=function(){this.tree=null,this.nodes=[],this.size=0},M.prototype.toString=function(){var e=this.first();return null==e?"":this.stringForNode(e)},M.prototype.evaluate=function(e){return this},M.prototype.string=function(){return new P(this.toString())},M.prototype.stringValue=function(){return this.toString()},M.prototype.number=function(){return new x(this.string())},M.prototype.numberValue=function(){return Number(this.string())},M.prototype.bool=function(){return new R(this.booleanValue())},M.prototype.booleanValue=function(){return!!this.size},M.prototype.nodeset=function(){return this},M.prototype.stringForNode=function(e){return 9==e.nodeType||1==e.nodeType||11===e.nodeType?this.stringForContainerNode(e):2===e.nodeType?e.value||e.nodeValue:e.isNamespaceNode?e.namespace:e.nodeValue},M.prototype.stringForContainerNode=function(e){for(var t="",r=e.firstChild;null!=r;r=r.nextSibling){var n=r.nodeType;1!==n&&3!==n&&4!==n&&9!==n&&11!==n||(t+=this.stringForNode(r))}return t},M.prototype.buildTree=function(){if(!this.tree&&this.nodes.length){this.tree=new D(this.nodes[0]);for(var e=1;e<this.nodes.length;e+=1)this.tree.add(this.nodes[e])}return this.tree},M.prototype.first=function(){var e=this.buildTree();if(null==e)return null;for(;null!=e.left;)e=e.left;return e.node},M.prototype.add=function(e){for(var t=0;t<this.nodes.length;t+=1)if(e===this.nodes[t])return;this.tree=null,this.nodes.push(e),this.size+=1},M.prototype.addArray=function(e){for(var t=0;t<e.length;t+=1)this.add(e[t])},M.prototype.toArray=function(){var e=[];return this.toArrayRec(this.buildTree(),e),e},M.prototype.toArrayRec=function(e,t){null!=e&&(this.toArrayRec(e.left,t),t.push(e.node),this.toArrayRec(e.right,t))},M.prototype.toUnsortedArray=function(){return this.nodes.slice()},M.prototype.compareWithString=function(e,t){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var s=r[n],a=t(new P(this.stringForNode(s)),e);if(a.booleanValue())return a}return new R(!1)},M.prototype.compareWithNumber=function(e,t){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var s=r[n],a=t(new x(this.stringForNode(s)),e);if(a.booleanValue())return a}return new R(!1)},M.prototype.compareWithBoolean=function(e,t){return t(this.bool(),e)},M.prototype.compareWithNodeSet=function(e,t){for(var r=this.toUnsortedArray(),n=function(e,r){return t(r,e)},s=0;s<r.length;s++){var a=new P(this.stringForNode(r[s])),o=e.compareWithString(a,n);if(o.booleanValue())return o}return new R(!1)},M.prototype.equals=function(e){return H.instance_of(e,P)?this.compareWithString(e,L.equals):H.instance_of(e,x)?this.compareWithNumber(e,L.equals):H.instance_of(e,R)?this.compareWithBoolean(e,L.equals):this.compareWithNodeSet(e,L.equals)},M.prototype.notequal=function(e){return H.instance_of(e,P)?this.compareWithString(e,L.notequal):H.instance_of(e,x)?this.compareWithNumber(e,L.notequal):H.instance_of(e,R)?this.compareWithBoolean(e,L.notequal):this.compareWithNodeSet(e,L.notequal)},M.prototype.lessthan=function(e){return H.instance_of(e,P)?this.compareWithNumber(e.number(),L.lessthan):H.instance_of(e,x)?this.compareWithNumber(e,L.lessthan):H.instance_of(e,R)?this.compareWithBoolean(e,L.lessthan):this.compareWithNodeSet(e,L.lessthan)},M.prototype.greaterthan=function(e){return H.instance_of(e,P)?this.compareWithNumber(e.number(),L.greaterthan):H.instance_of(e,x)?this.compareWithNumber(e,L.greaterthan):H.instance_of(e,R)?this.compareWithBoolean(e,L.greaterthan):this.compareWithNodeSet(e,L.greaterthan)},M.prototype.lessthanorequal=function(e){return H.instance_of(e,P)?this.compareWithNumber(e.number(),L.lessthanorequal):H.instance_of(e,x)?this.compareWithNumber(e,L.lessthanorequal):H.instance_of(e,R)?this.compareWithBoolean(e,L.lessthanorequal):this.compareWithNodeSet(e,L.lessthanorequal)},M.prototype.greaterthanorequal=function(e){return H.instance_of(e,P)?this.compareWithNumber(e.number(),L.greaterthanorequal):H.instance_of(e,x)?this.compareWithNumber(e,L.greaterthanorequal):H.instance_of(e,R)?this.compareWithBoolean(e,L.greaterthanorequal):this.compareWithNodeSet(e,L.greaterthanorequal)},M.prototype.union=function(e){var t=new M;return t.addArray(this.toUnsortedArray()),t.addArray(e.toUnsortedArray()),t},O.prototype=new Object,O.prototype.constructor=O,O.superclass=Object.prototype,O.prototype.toString=function(){return'{ "'+this.prefix+'", "'+this.namespaceURI+'" }'};var L=new Object;function _(e,t,r){this.variableResolver=null!=e?e:new I,this.namespaceResolver=null!=t?t:new F,this.functionResolver=null!=r?r:new B}function I(){}function B(e){this.thisArg=null!=e?e:V,this.functions=new Object,this.addStandardFunctions()}function F(){}L.equals=function(e,t){return e.equals(t)},L.notequal=function(e,t){return e.notequal(t)},L.lessthan=function(e,t){return e.lessthan(t)},L.greaterthan=function(e,t){return e.greaterthan(t)},L.lessthanorequal=function(e,t){return e.lessthanorequal(t)},L.greaterthanorequal=function(e,t){return e.greaterthanorequal(t)},_.prototype=new Object,_.prototype.constructor=_,_.superclass=Object.prototype,I.prototype=new Object,I.prototype.constructor=I,I.superclass=Object.prototype,I.prototype.getVariable=function(e,t){return null},B.prototype=new Object,B.prototype.constructor=B,B.superclass=Object.prototype,B.prototype.addStandardFunctions=function(){this.functions["{}last"]=V.last,this.functions["{}position"]=V.position,this.functions["{}count"]=V.count,this.functions["{}id"]=V.id,this.functions["{}local-name"]=V.localName,this.functions["{}namespace-uri"]=V.namespaceURI,this.functions["{}name"]=V.name,this.functions["{}string"]=V.string,this.functions["{}concat"]=V.concat,this.functions["{}starts-with"]=V.startsWith,this.functions["{}contains"]=V.contains,this.functions["{}substring-before"]=V.substringBefore,this.functions["{}substring-after"]=V.substringAfter,this.functions["{}substring"]=V.substring,this.functions["{}string-length"]=V.stringLength,this.functions["{}normalize-space"]=V.normalizeSpace,this.functions["{}translate"]=V.translate,this.functions["{}boolean"]=V.boolean_,this.functions["{}not"]=V.not,this.functions["{}true"]=V.true_,this.functions["{}false"]=V.false_,this.functions["{}lang"]=V.lang,this.functions["{}number"]=V.number,this.functions["{}sum"]=V.sum,this.functions["{}floor"]=V.floor,this.functions["{}ceiling"]=V.ceiling,this.functions["{}round"]=V.round},B.prototype.addFunction=function(e,t,r){this.functions["{"+e+"}"+t]=r},B.getFunctionFromContext=function(e,t){var r=H.resolveQName(e,t.namespaceResolver,t.contextNode,!1);if(null===r[0])throw new Error("Cannot resolve QName "+name);return t.functionResolver.getFunction(r[1],r[0])},B.prototype.getFunction=function(e,t){return this.functions["{"+t+"}"+e]},F.prototype=new Object,F.prototype.constructor=F,F.superclass=Object.prototype,F.prototype.getNamespace=function(e,t){if("xml"==e)return r.XML_NAMESPACE_URI;if("xmlns"==e)return r.XMLNS_NAMESPACE_URI;for(9==t.nodeType?t=t.documentElement:2==t.nodeType?t=E.prototype.getOwnerElement(t):1!=t.nodeType&&(t=t.parentNode);null!=t&&1==t.nodeType;){for(var n=t.attributes,s=0;s<n.length;s++){var a=n.item(s),o=a.name||a.nodeName;if("xmlns"===o&&""===e||o==="xmlns:"+e)return String(a.value||a.nodeValue)}t=t.parentNode}return null};var V=new Object;V.last=function(){var e=arguments[0];if(1!=arguments.length)throw new Error("Function last expects ()");return new x(e.contextSize)},V.position=function(){var e=arguments[0];if(1!=arguments.length)throw new Error("Function position expects ()");return new x(e.contextPosition)},V.count=function(){var e,t=arguments[0];if(2!=arguments.length||!H.instance_of(e=arguments[1].evaluate(t),M))throw new Error("Function count expects (node-set)");return new x(e.size)},V.id=function(){var e,t=arguments[0];if(2!=arguments.length)throw new Error("Function id expects (object)");e=arguments[1].evaluate(t);for(var r=(e=H.instance_of(e,M)?e.toArray().join(" "):e.stringValue()).split(/[\x0d\x0a\x09\x20]+/),n=new M,s=9==t.contextNode.nodeType?t.contextNode:t.contextNode.ownerDocument,a=0;a<r.length;a++){var o;null!=(o=s.getElementById?s.getElementById(r[a]):H.getElementById(s,r[a]))&&n.add(o)}return n},V.localName=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function local-name expects (node-set?)");e=arguments[1].evaluate(t).first()}return new P(null==e?"":e.localName||e.baseName||e.target||e.nodeName||"")},V.namespaceURI=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function namespace-uri expects (node-set?)");e=arguments[1].evaluate(t).first()}return new P(null==e?"":e.namespaceURI)},V.name=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function name expects (node-set?)");e=arguments[1].evaluate(t).first()}return null==e?new P(""):1==e.nodeType?new P(e.nodeName):2==e.nodeType?new P(e.name||e.nodeName):7===e.nodeType?new P(e.target||e.nodeName):null==e.localName?new P(""):new P(e.localName)},V.string=function(){var e=arguments[0];if(1==arguments.length)return new P(M.prototype.stringForNode(e.contextNode));if(2==arguments.length)return arguments[1].evaluate(e).string();throw new Error("Function string expects (object?)")},V.concat=function(){var e=arguments[0];if(arguments.length<3)throw new Error("Function concat expects (string, string, string*)");for(var t="",r=1;r<arguments.length;r++)t+=arguments[r].evaluate(e).stringValue();return new P(t)},V.startsWith=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function startsWith expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new R(t.substring(0,r.length)==r)},V.contains=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function contains expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new R(-1!==t.indexOf(r))},V.substringBefore=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-before expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new P(t.substring(0,t.indexOf(r)))},V.substringAfter=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-after expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();if(0==r.length)return new P(t);var n=t.indexOf(r);return new P(-1==n?"":t.substring(n+r.length))},V.substring=function(){var e=arguments[0];if(3!=arguments.length&&4!=arguments.length)throw new Error("Function substring expects (string, number, number?)");var t=arguments[1].evaluate(e).stringValue(),r=Math.round(arguments[2].evaluate(e).numberValue())-1,n=4==arguments.length?r+Math.round(arguments[3].evaluate(e).numberValue()):void 0;return new P(t.substring(r,n))},V.stringLength=function(){var e,t=arguments[0];if(1==arguments.length)e=M.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function string-length expects (string?)");e=arguments[1].evaluate(t).stringValue()}return new x(e.length)},V.normalizeSpace=function(){var e,t=arguments[0];if(1==arguments.length)e=M.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function normalize-space expects (string?)");e=arguments[1].evaluate(t).stringValue()}for(var r=0,n=e.length-1;H.isSpace(e.charCodeAt(n));)n--;for(var s="";r<=n&&H.isSpace(e.charCodeAt(r));)r++;for(;r<=n;)if(H.isSpace(e.charCodeAt(r)))for(s+=" ";r<=n&&H.isSpace(e.charCodeAt(r));)r++;else s+=e.charAt(r),r++;return new P(s)},V.translate=function(){var e=arguments[0];if(4!=arguments.length)throw new Error("Function translate expects (string, string, string)");for(var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue(),n=arguments[3].evaluate(e).stringValue(),s=[],a=0;a<r.length;a++){var o=r.charCodeAt(a);if(null==s[o]){var i=a>n.length?"":n.charAt(a);s[o]=i}}var l="";for(a=0;a<t.length;a++){var c=s[e=t.charCodeAt(a)];l+=null==c?t.charAt(a):c}return new P(l)},V.boolean_=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function boolean expects (object)");return arguments[1].evaluate(e).bool()},V.not=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function not expects (object)");return arguments[1].evaluate(e).bool().not()},V.true_=function(){if(1!=arguments.length)throw new Error("Function true expects ()");return new R(!0)},V.false_=function(){if(1!=arguments.length)throw new Error("Function false expects ()");return new R(!1)},V.lang=function(){var e,t=arguments[0];if(2!=arguments.length)throw new Error("Function lang expects (string)");for(var n=t.contextNode;null!=n&&9!=n.nodeType;n=n.parentNode){var s=n.getAttributeNS(r.XML_NAMESPACE_URI,"lang");if(null!=s){e=String(s);break}}if(null==e)return new R(!1);var a=arguments[1].evaluate(t).stringValue();return new R(e.substring(0,a.length)==a&&(e.length==a.length||"-"==e.charAt(a.length)))},V.number=function(){var e=arguments[0];if(1!=arguments.length&&2!=arguments.length)throw new Error("Function number expects (object?)");return 1==arguments.length?new x(M.prototype.stringForNode(e.contextNode)):arguments[1].evaluate(e).number()},V.sum=function(){var e,t=arguments[0];if(2!=arguments.length||!H.instance_of(e=arguments[1].evaluate(t),M))throw new Error("Function sum expects (node-set)");e=e.toUnsortedArray();for(var r=0,n=0;n<e.length;n++)r+=new x(M.prototype.stringForNode(e[n])).numberValue();return new x(r)},V.floor=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function floor expects (number)");return new x(Math.floor(arguments[1].evaluate(e).numberValue()))},V.ceiling=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function ceiling expects (number)");return new x(Math.ceil(arguments[1].evaluate(e).numberValue()))},V.round=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function round expects (number)");return new x(Math.round(arguments[1].evaluate(e).numberValue()))};var H=new Object;H.isAttribute=function(e){return e&&(2===e.nodeType||e.ownerElement)},H.splitQName=function(e){var t=e.indexOf(":");return-1==t?[null,e]:[e.substring(0,t),e.substring(t+1)]},H.resolveQName=function(e,t,r,n){var s=H.splitQName(e);return null!=s[0]?s[0]=t.getNamespace(s[0],r):n?(s[0]=t.getNamespace("",r),null==s[0]&&(s[0]="")):s[0]="",s},H.isSpace=function(e){return 9==e||13==e||10==e||32==e},H.isLetter=function(e){return e>=65&&e<=90||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=255||e>=256&&e<=305||e>=308&&e<=318||e>=321&&e<=328||e>=330&&e<=382||e>=384&&e<=451||e>=461&&e<=496||e>=500&&e<=501||e>=506&&e<=535||e>=592&&e<=680||e>=699&&e<=705||902==e||e>=904&&e<=906||908==e||e>=910&&e<=929||e>=931&&e<=974||e>=976&&e<=982||986==e||988==e||990==e||992==e||e>=994&&e<=1011||e>=1025&&e<=1036||e>=1038&&e<=1103||e>=1105&&e<=1116||e>=1118&&e<=1153||e>=1168&&e<=1220||e>=1223&&e<=1224||e>=1227&&e<=1228||e>=1232&&e<=1259||e>=1262&&e<=1269||e>=1272&&e<=1273||e>=1329&&e<=1366||1369==e||e>=1377&&e<=1414||e>=1488&&e<=1514||e>=1520&&e<=1522||e>=1569&&e<=1594||e>=1601&&e<=1610||e>=1649&&e<=1719||e>=1722&&e<=1726||e>=1728&&e<=1742||e>=1744&&e<=1747||1749==e||e>=1765&&e<=1766||e>=2309&&e<=2361||2365==e||e>=2392&&e<=2401||e>=2437&&e<=2444||e>=2447&&e<=2448||e>=2451&&e<=2472||e>=2474&&e<=2480||2482==e||e>=2486&&e<=2489||e>=2524&&e<=2525||e>=2527&&e<=2529||e>=2544&&e<=2545||e>=2565&&e<=2570||e>=2575&&e<=2576||e>=2579&&e<=2600||e>=2602&&e<=2608||e>=2610&&e<=2611||e>=2613&&e<=2614||e>=2616&&e<=2617||e>=2649&&e<=2652||2654==e||e>=2674&&e<=2676||e>=2693&&e<=2699||2701==e||e>=2703&&e<=2705||e>=2707&&e<=2728||e>=2730&&e<=2736||e>=2738&&e<=2739||e>=2741&&e<=2745||2749==e||2784==e||e>=2821&&e<=2828||e>=2831&&e<=2832||e>=2835&&e<=2856||e>=2858&&e<=2864||e>=2866&&e<=2867||e>=2870&&e<=2873||2877==e||e>=2908&&e<=2909||e>=2911&&e<=2913||e>=2949&&e<=2954||e>=2958&&e<=2960||e>=2962&&e<=2965||e>=2969&&e<=2970||2972==e||e>=2974&&e<=2975||e>=2979&&e<=2980||e>=2984&&e<=2986||e>=2990&&e<=2997||e>=2999&&e<=3001||e>=3077&&e<=3084||e>=3086&&e<=3088||e>=3090&&e<=3112||e>=3114&&e<=3123||e>=3125&&e<=3129||e>=3168&&e<=3169||e>=3205&&e<=3212||e>=3214&&e<=3216||e>=3218&&e<=3240||e>=3242&&e<=3251||e>=3253&&e<=3257||3294==e||e>=3296&&e<=3297||e>=3333&&e<=3340||e>=3342&&e<=3344||e>=3346&&e<=3368||e>=3370&&e<=3385||e>=3424&&e<=3425||e>=3585&&e<=3630||3632==e||e>=3634&&e<=3635||e>=3648&&e<=3653||e>=3713&&e<=3714||3716==e||e>=3719&&e<=3720||3722==e||3725==e||e>=3732&&e<=3735||e>=3737&&e<=3743||e>=3745&&e<=3747||3749==e||3751==e||e>=3754&&e<=3755||e>=3757&&e<=3758||3760==e||e>=3762&&e<=3763||3773==e||e>=3776&&e<=3780||e>=3904&&e<=3911||e>=3913&&e<=3945||e>=4256&&e<=4293||e>=4304&&e<=4342||4352==e||e>=4354&&e<=4355||e>=4357&&e<=4359||4361==e||e>=4363&&e<=4364||e>=4366&&e<=4370||4412==e||4414==e||4416==e||4428==e||4430==e||4432==e||e>=4436&&e<=4437||4441==e||e>=4447&&e<=4449||4451==e||4453==e||4455==e||4457==e||e>=4461&&e<=4462||e>=4466&&e<=4467||4469==e||4510==e||4520==e||4523==e||e>=4526&&e<=4527||e>=4535&&e<=4536||4538==e||e>=4540&&e<=4546||4587==e||4592==e||4601==e||e>=7680&&e<=7835||e>=7840&&e<=7929||e>=7936&&e<=7957||e>=7960&&e<=7965||e>=7968&&e<=8005||e>=8008&&e<=8013||e>=8016&&e<=8023||8025==e||8027==e||8029==e||e>=8031&&e<=8061||e>=8064&&e<=8116||e>=8118&&e<=8124||8126==e||e>=8130&&e<=8132||e>=8134&&e<=8140||e>=8144&&e<=8147||e>=8150&&e<=8155||e>=8160&&e<=8172||e>=8178&&e<=8180||e>=8182&&e<=8188||8486==e||e>=8490&&e<=8491||8494==e||e>=8576&&e<=8578||e>=12353&&e<=12436||e>=12449&&e<=12538||e>=12549&&e<=12588||e>=44032&&e<=55203||e>=19968&&e<=40869||12295==e||e>=12321&&e<=12329},H.isNCNameChar=function(e){return e>=48&&e<=57||e>=1632&&e<=1641||e>=1776&&e<=1785||e>=2406&&e<=2415||e>=2534&&e<=2543||e>=2662&&e<=2671||e>=2790&&e<=2799||e>=2918&&e<=2927||e>=3047&&e<=3055||e>=3174&&e<=3183||e>=3302&&e<=3311||e>=3430&&e<=3439||e>=3664&&e<=3673||e>=3792&&e<=3801||e>=3872&&e<=3881||46==e||45==e||95==e||H.isLetter(e)||e>=768&&e<=837||e>=864&&e<=865||e>=1155&&e<=1158||e>=1425&&e<=1441||e>=1443&&e<=1465||e>=1467&&e<=1469||1471==e||e>=1473&&e<=1474||1476==e||e>=1611&&e<=1618||1648==e||e>=1750&&e<=1756||e>=1757&&e<=1759||e>=1760&&e<=1764||e>=1767&&e<=1768||e>=1770&&e<=1773||e>=2305&&e<=2307||2364==e||e>=2366&&e<=2380||2381==e||e>=2385&&e<=2388||e>=2402&&e<=2403||e>=2433&&e<=2435||2492==e||2494==e||2495==e||e>=2496&&e<=2500||e>=2503&&e<=2504||e>=2507&&e<=2509||2519==e||e>=2530&&e<=2531||2562==e||2620==e||2622==e||2623==e||e>=2624&&e<=2626||e>=2631&&e<=2632||e>=2635&&e<=2637||e>=2672&&e<=2673||e>=2689&&e<=2691||2748==e||e>=2750&&e<=2757||e>=2759&&e<=2761||e>=2763&&e<=2765||e>=2817&&e<=2819||2876==e||e>=2878&&e<=2883||e>=2887&&e<=2888||e>=2891&&e<=2893||e>=2902&&e<=2903||e>=2946&&e<=2947||e>=3006&&e<=3010||e>=3014&&e<=3016||e>=3018&&e<=3021||3031==e||e>=3073&&e<=3075||e>=3134&&e<=3140||e>=3142&&e<=3144||e>=3146&&e<=3149||e>=3157&&e<=3158||e>=3202&&e<=3203||e>=3262&&e<=3268||e>=3270&&e<=3272||e>=3274&&e<=3277||e>=3285&&e<=3286||e>=3330&&e<=3331||e>=3390&&e<=3395||e>=3398&&e<=3400||e>=3402&&e<=3405||3415==e||3633==e||e>=3636&&e<=3642||e>=3655&&e<=3662||3761==e||e>=3764&&e<=3769||e>=3771&&e<=3772||e>=3784&&e<=3789||e>=3864&&e<=3865||3893==e||3895==e||3897==e||3902==e||3903==e||e>=3953&&e<=3972||e>=3974&&e<=3979||e>=3984&&e<=3989||3991==e||e>=3993&&e<=4013||e>=4017&&e<=4023||4025==e||e>=8400&&e<=8412||8417==e||e>=12330&&e<=12335||12441==e||12442==e||183==e||720==e||721==e||903==e||1600==e||3654==e||3782==e||12293==e||e>=12337&&e<=12341||e>=12445&&e<=12446||e>=12540&&e<=12542},H.coalesceText=function(e){for(var t=e.firstChild;null!=t;t=t.nextSibling)if(3==t.nodeType||4==t.nodeType){var r=t.nodeValue,n=t;for(t=t.nextSibling;null!=t&&(3==t.nodeType||4==t.nodeType);){r+=t.nodeValue;var s=t;t=t.nextSibling,s.parentNode.removeChild(s)}if(4==n.nodeType){var a=n.parentNode;if(null==n.nextSibling)a.removeChild(n),a.appendChild(a.ownerDocument.createTextNode(r));else{var o=n.nextSibling;a.removeChild(n),a.insertBefore(a.ownerDocument.createTextNode(r),o)}}else n.nodeValue=r;if(null==t)break}else 1==t.nodeType&&H.coalesceText(t)},H.instance_of=function(e,t){for(;null!=e;){if(e.constructor===t)return!0;if(e===Object)return!1;e=e.constructor.superclass}return!1},H.getElementById=function(e,t){if(1==e.nodeType&&(e.getAttribute("id")==t||e.getAttributeNS(null,"id")==t))return e;for(var r=e.firstChild;null!=r;r=r.nextSibling){var n=H.getElementById(r,t);if(null!=n)return n}return null};var $=function(){function e(t,r,n){var s=Error.call(this,function(t,r){var n=r?": "+r.toString():"";switch(t){case e.INVALID_EXPRESSION_ERR:return"Invalid expression"+n;case e.TYPE_ERR:return"Type error"+n}return null}(t,r)||n);return s.code=t,s.exception=r,s}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.superclass=Error,e.prototype.toString=function(){return this.message},e.fromMessage=function(t,r){return new e(null,r,t)},e.INVALID_EXPRESSION_ERR=51,e.TYPE_ERR=52,e}();function U(e,t,r){this.xpath=r.parse(e),this.context=new _,this.context.namespaceResolver=new W(t)}function W(e){this.xpathNSResolver=e}function j(e){this.node=e,this.namespaceResolver=new F}function G(e,t){switch(t==G.ANY_TYPE&&(e.constructor===P?t=G.STRING_TYPE:e.constructor===x?t=G.NUMBER_TYPE:e.constructor===R?t=G.BOOLEAN_TYPE:e.constructor===M&&(t=G.UNORDERED_NODE_ITERATOR_TYPE)),this.resultType=t,t){case G.NUMBER_TYPE:return void(this.numberValue=e.numberValue());case G.STRING_TYPE:return void(this.stringValue=e.stringValue());case G.BOOLEAN_TYPE:return void(this.booleanValue=e.booleanValue());case G.ANY_UNORDERED_NODE_TYPE:case G.FIRST_ORDERED_NODE_TYPE:if(e.constructor===M)return void(this.singleNodeValue=e.first());break;case G.UNORDERED_NODE_ITERATOR_TYPE:case G.ORDERED_NODE_ITERATOR_TYPE:if(e.constructor===M)return this.invalidIteratorState=!1,this.nodes=e.toArray(),void(this.iteratorIndex=0);break;case G.UNORDERED_NODE_SNAPSHOT_TYPE:case G.ORDERED_NODE_SNAPSHOT_TYPE:if(e.constructor===M)return this.nodes=e.toArray(),void(this.snapshotLength=this.nodes.length)}throw new $($.TYPE_ERR)}function q(e,t){e.createExpression=function(e,r){try{return new U(e,r,t)}catch(e){throw new $($.INVALID_EXPRESSION_ERR,e)}},e.createNSResolver=function(e){return new j(e)},e.evaluate=function(r,n,s,a,o){if(a<0||a>9)throw{code:0,toString:function(){return"Request type not supported"}};return e.createExpression(r,s,t).evaluate(n,a,o)}}U.prototype={},U.prototype.constructor=U,U.superclass=Object.prototype,U.prototype.evaluate=function(e,t,r){return this.context.expressionContextNode=e,new G(this.xpath.evaluate(this.context),t)},W.prototype={},W.prototype.constructor=W,W.superclass=Object.prototype,W.prototype.getNamespace=function(e,t){return null==this.xpathNSResolver?null:this.xpathNSResolver.lookupNamespaceURI(e)},j.prototype={},j.prototype.constructor=j,j.superclass=Object.prototype,j.prototype.lookupNamespaceURI=function(e){return this.namespaceResolver.getNamespace(e,this.node)},G.prototype={},G.prototype.constructor=G,G.superclass=Object.prototype,G.prototype.iterateNext=function(){if(this.resultType!=G.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=G.ORDERED_NODE_ITERATOR_TYPE)throw new $($.TYPE_ERR);return this.nodes[this.iteratorIndex++]},G.prototype.snapshotItem=function(e){if(this.resultType!=G.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=G.ORDERED_NODE_SNAPSHOT_TYPE)throw new $($.TYPE_ERR);return this.nodes[e]},G.ANY_TYPE=0,G.NUMBER_TYPE=1,G.STRING_TYPE=2,G.BOOLEAN_TYPE=3,G.UNORDERED_NODE_ITERATOR_TYPE=4,G.ORDERED_NODE_ITERATOR_TYPE=5,G.UNORDERED_NODE_SNAPSHOT_TYPE=6,G.ORDERED_NODE_SNAPSHOT_TYPE=7,G.ANY_UNORDERED_NODE_TYPE=8,G.FIRST_ORDERED_NODE_TYPE=9;try{var z=!0;try{document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("XPath",null)&&(z=!1)}catch(e){}z&&q(document,new t)}catch(e){}q(e,new t),function(){var r=new t,n=new F,s=new B,a=new I;function o(e){return{getNamespace:function(t,r){return e(t,r)||n.getNamespace(t,r)}}}function i(e){return e&&"function"==typeof e.getNamespace?o((t=e).getNamespace.bind(t)):"function"==typeof e?o(e):"object"==typeof e?(r=e,o(function(e){return r[e]})):n;var t,r}function l(e){if(null==e||e instanceof P||e instanceof R||e instanceof x||e instanceof M)return e;switch(typeof e){case"string":return new P(e);case"boolean":return new R(e);case"number":return new x(e)}var t=new M;return t.addArray([].concat(e)),t}function c(e){return{getFunction:function(t,r){var n=e(t,r);return n?function(e){return function(t){var r=Array.prototype.slice.call(arguments,1).map(function(e){return e.evaluate(t)});return l(e.apply(this,[].concat(t,r)))}}(n):s.getFunction(t,r)}}}function u(e){return e&&"function"==typeof e.getFunction?c((t=e).getFunction.bind(t)):"function"==typeof e?c(e):"object"==typeof e?(r=e,c(function(e){return r[e]})):s;var t,r}function h(e){return{getVariable:function(t,r){return l(e(t,r))}}}function p(e){var t=new _;return e?(t.namespaceResolver=i(e.namespaces),t.functionResolver=u(e.functions),t.variableResolver=function(e){if(e){if("function"==typeof e.getVariable)return h(e.getVariable.bind(e));if("function"==typeof e)return h(e);if("object"==typeof e)return h(function(t){return e[t]})}return a}(e.variables),t.expressionContextNode=e.node):t.namespaceResolver=n,t}var m={evaluate:function(e){return function(e,t){var r=p(t);return e.evaluate(r)}(this.expression,e)},evaluateNumber:function(e){return this.evaluate(e).numberValue()},evaluateString:function(e){return this.evaluate(e).stringValue()},evaluateBoolean:function(e){return this.evaluate(e).booleanValue()},evaluateNodeSet:function(e){return this.evaluate(e).nodeset()},select:function(e){return this.evaluateNodeSet(e).toArray()},select1:function(e){return this.select(e)[0]}};e.parse=function(e){var t=r.parse(e);return Object.create(m,{expression:{value:t}})}}(),e.XPath=r,e.XPathParser=t,e.XPathResult=G,e.Step=A,e.NodeTest=k,e.BarOperation=N,e.NamespaceResolver=F,e.FunctionResolver=B,e.VariableResolver=I,e.Utilities=H,e.XPathContext=_,e.XNodeSet=M,e.XBoolean=R,e.XString=P,e.XNumber=x,e.select=function(t,r,n){return e.selectWithResolver(t,r,null,n)},e.useNamespaces=function(t){var r={mappings:t||{},lookupNamespaceURI:function(e){return this.mappings[e]}};return function(t,n,s){return e.selectWithResolver(t,n,r,s)}},e.selectWithResolver=function(e,r,n,s){var a=new U(e,n,new t),o=G.ANY_TYPE,i=a.evaluate(r,o,null);return i.resultType==G.STRING_TYPE?i=i.stringValue:i.resultType==G.NUMBER_TYPE?i=i.numberValue:i.resultType==G.BOOLEAN_TYPE?i=i.booleanValue:(i=i.nodes,s&&(i=i[0])),i},e.select1=function(t,r){return e.select(t,r,!0)}}(e)}(at)),at}var it,lt,ct,ut,ht,pt={};function mt(){if(ct)return pt;ct=1;let e=function(){if(lt)return it;lt=1;var e=/[|\\{}()[\]^$+*?.]/g;return it=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(e,"\\$&")}}();return pt.oprx=new RegExp(["","!",'"',"#","&","(",")","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_","`","{","|","}","~","","","","","","","","","","","","","","~","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].map(t=>e(t)).join("|")),pt}var dt=function(){if(ht)return ut;ht=1;let e,t=function(){if(qe)return Ge;qe=1;let{ELEMENT_NODE:e,TEXT_NODE:t,CDATA_SECTION_NODE:r,DOCUMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:s}=Ze();return Ge=class{constructor({mode:e="function"}={}){this.templates=[],this.mode=e,this.lookupText=null,this.lookupDocument=null,this.lookupElement={}}match(e,t){if(Array.isArray(e)||(e=[e]),"function"===this.mode){if(e.find(e=>"function"!=typeof e))throw new Error("All matchers must be functions");this.templates.push({matcher:e,template:t})}else{if("lookup"!==this.mode)throw new Error(`Unknown mode ${this.mode}`);if(e.find(e=>!e.nt))throw new Error("All matchers must be objects with a type");e.forEach(({nt:e,ns:r,ln:n})=>{if("text"===e){if(this.lookupText)throw new Error("You can only have one text lookup template");this.lookupText=t}else if("document"===e){if(this.lookupDocument)throw new Error("You can only have one document lookup template");this.lookupDocument=t}else{if("element"!==e)throw new Error(`Unknown lookup node type "${e}"`);if(this.lookupElement[r]||(this.lookupElement[r]={}),this.lookupElement[r][n])throw new Error(`You can only have one element lookup template ${r}|${n}`);this.lookupElement[r][n]=t}})}return this}result(e){this.res=e}findMatch(a){let o=a.nodeType;if("function"===this.mode)for(let e=0;e<this.templates.length;e++){let t=this.templates[e];if(!t.matcher.some(e=>e(a)))continue;this.stack.unshift(a);let r=t.template(a,this.out[0],this);return this.stack.shift(),r}else{if("lookup"!==this.mode)throw new Error(`Unknown mode ${this.mode}`);if((o===t||o===r)&&this.lookupText){this.stack.unshift(a);let e=this.lookupText(a,this.out[0],this);return this.stack.shift(),e}if(o===n&&this.lookupDocument){this.stack.unshift(a);let e=this.lookupDocument(a,this.out[0],this);return this.stack.shift(),e}if(o===e){let{namespaceURI:e,localName:t}=a,r=this.lookupElement[e]&&this.lookupElement[e][t]||this.lookupElement[""]&&this.lookupElement[""]["*"];if(r){this.stack.unshift(a);let e=r(a,this.out[0],this);return this.stack.shift(),e}}}if(o===t||o===r){let e=this.out[0];if(e){let t=e.ownerDocument.createTextNode(a.textContent);e.appendChild(t)}return a}if(o===e||o===n||o===s){this.stack.unshift(a);let e=this.walk(this.out[0]);return this.stack.shift(),e}}walk(e,t){this.out.unshift(e);let r=[];if(t)Array.isArray(t)||(t=[t]),t.forEach(e=>r.push(this.findMatch(e)));else{let e=this.stack[0].firstChild;for(;e;)r.push(this.findMatch(e)),e=e.nextSibling}return this.out.shift(),r}run(e,t){if(this.stack=[],this.out=[],this.res=null,!t)return this.findMatch(e),this.res;process.nextTick(()=>{this.findMatch(e),t(null,this.res)})}},Ge}(),r=tt(),n=et(),s=function(){if(Ke)return Qe;Ke=1;let{ELEMENT_NODE:e,TEXT_NODE:t,CDATA_SECTION_NODE:r,DOCUMENT_NODE:n}=Ze(),s=et(),a=e=>e.toLowerCase();return Qe=class{constructor(e={},t=!1){this.ns=e,this.ci=t}text(){return e=>e.nodeType===t||e.nodeType===r}document(){return e=>e.nodeType===n}el(t){let r=s(t,this.ns);return r.ns?t=>!(t.nodeType!==e||t.namespaceURI!==r.ns&&"*"!==r.ns||(this.ci?a(t.localName)!==a(r.ln):t.localName!==r.ln)&&"*"!==r.ln):r=>r.nodeType===e&&((this.ci?a(r.nodeName)===a(t):r.nodeName===t)||"*"===t)}},Qe}(),a=(rt||(rt=1,nt.document=function(){return document},nt.implementation=function(){return document.implementation}),nt),o=ot(),{oprx:i}=mt(),l={m:"http://schemas.openxmlformats.org/officeDocument/2006/math"},c=o.useNamespaces(l),u=(e,t,r,s=!1)=>{let a=c(e,r)[0];if(!a)return s?void 0:"";let o=n(t,l);return o.ns?a.getAttributeNS(o.ns,o.ln):a.getAttribute(o.qn)};function h(e){if(e)return e.replace(/\s/g,"")}function p(e){if(null!=e)return"on"===(e=e.toLowerCase())||"1"===e||"true"===e||"off"!==e&&"0"!==e&&"false"!==e&&void 0}function m(e){return!1!==p(e)}function d(e){return p(e)||!1}function f(t,r,{toParse:n="",scr:s,sty:a,nor:o}){if(!n.length)return;let l=b(n,i),u=b(n,/\d/),p=1===l;if(p||1===u)if(p){e("mo",y({nor:o,tokenType:"mo"}),r).textContent=n.substr(0,1),f(t,r,{toParse:n.substr(1),scr:s,sty:a,nor:o})}else{let i=v(n);e("mn",y({scr:s,sty:"p",nor:o,tokenType:"mn"}),r).textContent=i,f(t,r,{toParse:n.substr(i.length),scr:s,sty:a,nor:o})}else{let i;i=c("ancestor::m:fName",t)[0]?l||u?Math.min(l||Number.MAX_VALUE,u||Number.MAX_VALUE)-1:n.length:1,e("mi",y({scr:s,sty:a,nor:o,charToPrint:i,tokenType:"mi"}),r).textContent=h(n.substr(0,i)),f(t,r,{toParse:n.substr(i),scr:s,sty:a,nor:o})}}function g(t,r,{toParse:n="",scr:s,sty:a,nor:o,align:l}){if(n.length)if("&"===n[0])e(l?"malignmark":"maligngroup",{},r),g(t,r,{toParse:n.substr(1),align:!l,scr:s,sty:a,nor:o});else{let c=b(n,i),u=b(n,/\d/),p=1===c;if(p||1===u)if(p){if(o){e("mtext",{},r).textContent=n.substr(0,1)}else{e("mo",y({nor:o,charToPrint:1,tokenType:"mo"}),r).textContent=n.substr(0,1)}g(t,r,{toParse:n.substr(1),scr:s,sty:a,nor:o,align:l})}else{let i=v(n);if(o){e("mtext",{},r).textContent=n.substr(0,i.length)}else{e("mn",y({sty:"p",nor:o,charToPrint:1,tokenType:"mn"}),r).textContent=n.substr(0,i.length)}g(t,r,{toParse:n.substr(i.length),scr:s,sty:a,nor:o,align:l})}else{if(o){e("mtext",{},r).textContent=h(n.substr(0,1))}else{e("mi",y({scr:s,sty:a,nor:o,charToPrint:1,tokenType:"mi"}),r).textContent=h(n.substr(0,1))}g(t,r,{toParse:n.substr(1),scr:s,sty:a,nor:o,align:l})}}}function b(e,t){let r=t.exec(e);return r?r.index+1:0}function y({scr:e,sty:t,nor:r,charToPrint:n=0,tokenType:s}){let a={};if(r)a.mathvariant="normal";else{let r,o="b"===t||"bi"===t?"bold":"normal",i="b"===t||"p"===t?"normal":"italic";if("mn"!==s&&("monospace"===e?r="monospace":"sans-serif"===e&&"i"===t?r="sans-serif-italic":"sans-serif"===e&&"b"===t?r="bold-sans-serif":"sans-serif"===e&&"bi"===t?r="sans-serif-bold-italic":"sans-serif"===e?r="sans-serif":"fraktur"!==e||"b"!==t&&"i"!==t?"fraktur"===e?r="fraktur":"double-struck"===e?r="double-struck":"script"!==e||"b"!==t&&"i"!==t?"script"===e?r="script":"roman"!==e&&e||("b"===t?r="bold":"i"===t?r="italic":"p"===t?r="normal":"bi"===t&&(r="bold-italic")):r="bold-script":r="bold-fraktur"),"mo"===s&&"normal"!==r)return a;if("mi"===s&&1===n&&("italic"===r||!r))return a;"mi"===s&&n>1&&("italic"===r||!r)?a.mathvariant="italic":r&&"italic"!==r?a.mathvariant=r:("italic"!==i||"mi"===s&&1===n||(a.fontstyle="italic"),"bold"===o&&(a.fontweight="bold"))}return a}function v(e){if(!e)return"";let t="";return e.replace(/^(\d+)/,(e,r)=>{t=r}),t}function N(t,r,n){if(n&&n.length){let s=e("mrow",{},r);t.walk(s,n)}else e("none",{},r)}function E(t,r,n,s=!1){let a=e("mo",{stretchy:s?"true":"false"},r),o=u("./m:naryPr[last()]/m:chr","m:val",t);a.textContent=o||""}function w(e,t,r,n,s){let a=c("m:t",s).map(e=>e.textContent).join("");if(c("self::m:r",s)[0]){let e=u("m:rPr[last()]/m:nor","m:val",t)||!1;e&&(e=m(e)),g(t,r,{toParse:a,scr:u("../m:rPr[last()]/m:scr","m:val",t),sty:u("../m:rPr[last()]/m:sty","m:val",t),nor:e,align:n})}else e.walk(r,s);if(c("following-sibling::*",s).length){let o=function(e){return((e||"").match(/&/g)||[]).length}(a);w(e,t,r,(n+o%2)%2,c("following-sibling::*",s)[0])}}ut=function(r){let n=new s(l);return(new t).match(n.document(),k).match(n.el("m:oMathPara"),(e,t,r)=>{k(e,t,r),r.res.setAttribute("display","block"),r.walk(t)}).match(n.el("m:oMath"),(e,t,r)=>{k(e,t,r);let n=e.parentNode;n&&n.namespaceURI===l.m&&"oMathPara"===n.localName&&r.res.setAttribute("display","block"),r.walk(t)}).match(n.el("m:f"),(t,r,n)=>{let s=(u("./m:fPr[last()]/m:type","m:val",t)||"").toLowerCase(),a="lin"===s?e("mrow",{},r):e("mfrac",function(e){return"skw"===e||"lin"===e?{bevelled:"true"}:"nobar"===e?{linethickness:"0pt"}:{}}(s),r),o=e("mrow",{},a);if(n.walk(o,c("m:num[1]",t)),"lin"===s){e("mo",{},a).textContent="/"}let i=e("mrow",{},a);n.walk(i,c("m:den[1]",t))}).match(n.el("m:r"),(t,r)=>{let n=u("m:rPr[last()]/m:nor","m:val",t)||!1;if(n&&(n=m(n)),n){e("mtext",{},r).textContent=h(c(".//m:t",t).map(e=>e.textContent).join(""))}else c(".//m:t",t).forEach(e=>{f(t,r,{toParse:c("./text()",e).map(e=>e.data).join(""),scr:u("../m:rPr[last()]/m:scr","m:val",e),sty:u("../m:rPr[last()]/m:sty","m:val",e),nor:!1})})}).match(n.el("m:limLow"),(t,r,n)=>{let s=e("munder",{},r),a=e("mrow",{},s),o=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:lim[1]",t))}).match(n.el("m:limUpp"),(t,r,n)=>{let s=e("mover",{},r),a=e("mrow",{},s),o=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:lim[1]",t))}).match(n.el("m:sSub"),(t,r,n)=>{let s=e("msub",{},r),a=e("mrow",{},s),o=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:sub[1]",t))}).match(n.el("m:sSup"),(t,r,n)=>{let s=e("msup",{},r),a=e("mrow",{},s),o=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:sup[1]",t))}).match(n.el("m:sSubSup"),(t,r,n)=>{let s=e("msubsup",{},r),a=e("mrow",{},s),o=e("mrow",{},s),i=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:sub[1]",t)),n.walk(i,c("m:sup[1]",t))}).match(n.el("m:sPre"),(t,r,n)=>{let s=e("mmultiscripts",{},r),a=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),e("mprescripts",{},s),N(n,s,c("m:sub[1]",t)),N(n,s,c("m:sup[1]",t))}).match(n.el("m:m"),(t,r,n)=>{let s=u("m:mPr[last()]/m:mcs/m:mc/m:mcPr[last()]/m:mcJc","m:val",t).toLowerCase(),a=e("mtable",s&&"center"!==s?{columnalign:s}:{},r);c("m:mr",t).forEach(t=>{let r=e("mtr",{},a);c("m:e",t).forEach(t=>{let s=e("mtd",{},r);n.walk(s,t)})})}).match(n.el("m:rad"),(t,r,n)=>{let s=u("m:radPr[last()]/m:degHide","m:val",t)||!1;if(s&&(s=m(s)),s){let s=e("msqrt",{},r);n.walk(s,c("m:e[1]",t))}else{let s=e("mroot",{},r),a=e("mrow",{},s),o=e("mrow",{},s);n.walk(a,c("m:e[1]",t)),n.walk(o,c("m:deg[1]",t))}}).match(n.el("m:nary"),(t,r,n)=>{let s=u("m:naryPr[last()]/m:subHide","m:val",t)||!1;s&&(s=m(s));let a=u("m:naryPr[last()]/m:supHide","m:val",t)||!1;a&&(a=m(a));let o=u("m:naryPr[last()]/m:limLoc","m:val",t).toLowerCase();o=""===o||"subsup"===o;let i=u("m:naryPr[last()]/m:grow","m:val",t)||!1;i&&(i=m(i));let l=e("mrow",{},r);if(a&&s)E(t,l,t,i);else if(s){let r=e(o?"msup":"mover",{},l);E(t,r,t,i);let s=e("mrow",{},r);n.walk(s,c("m:sup[1]",t))}else if(a){let r=e(o?"msub":"munder",{},l);E(t,r,t,i);let s=e("mrow",{},r);n.walk(s,c("m:sub[1]",t))}else{let r=e(o?"msubsup":"munderover",{},l);E(t,r,t,i);let s=e("mrow",{},r),a=e("mrow",{},r);n.walk(s,c("m:sub[1]",t)),n.walk(a,c("m:sup[1]",t))}let h=e("mrow",{},l);n.walk(h,c("m:e[1]",t))}).match(n.el("m:d"),(t,r,n)=>{let s={},a=u("m:dPr[1]/m:begChr","m:val",t,!0),o=u("m:dPr[1]/m:endChr","m:val",t,!0),i=u("m:dPr[1]/m:sepChr","m:val",t)||"|";void 0!==a&&"("!==a&&(s.open=a),void 0!==o&&")"!==o&&(s.close=o),","!==i&&(s.separators=i);let l=e("mfenced",s,r);c("m:e",t).forEach(t=>{let r=e("mrow",{},l);n.walk(r,t)})}).match(n.el("m:eqArr"),(t,r,n)=>{let s=e("mtable",{},r);c("m:e",t).forEach(r=>{let a,o=e("mtr",{},s),i=e("mtd",{},o),l=u("m:argPr[last()]/m:scrLvl","m:val",r);a="0"===l&&l?e("mstyle",{scriptlevel:l},i):e("mrow",{},i),e("maligngroup",{},a),w(n,t,a,1,c("*[1]",r)[0])})}).match(n.el("m:func"),(t,r,n)=>{let s=e("mrow",{},r),a=e("mrow",{},s);c("m:fName",t).forEach(e=>n.walk(a,e)),e("mo",{},s).textContent="";let o=e("mrow",{},s);n.walk(o,c("m:e",t))}).match(n.el("m:acc"),(t,r,n)=>{let s=e("mover",{accent:"true"},r),a=e("mrow",{},s),o=u("m:accPr/m:chr","m:val",t).substr(0,1)||"",i=S[l=o]||l;var l;if(n.walk(a,c("m:e[1]",t)),0===o.length)e("mo",{},s);else{let e=u("m:rPr[last()]/m:nor","m:val",t)||!1;e&&(e=m(e)),f(t,s,{toParse:i,scr:u("m:e[1]/*/m:rPr[last()]/m:scr","m:val",t),sty:u("m:e[1]/*/m:rPr[last()]/m:sty","m:val",t),nor:e})}}).match(n.el("m:groupChr"),(t,r,n)=>{let s=c("m:groupChrPr[last()]",t)[0],a=u("m:pos","m:val",s).toLowerCase(),o=u("m:vertJc","m:val",s).toLowerCase(),i=u("m:chr","m:val",s),l=i?i.substr(0,1):"",h=r=>{let s=e("mrow",{},r);n.walk(s,c("m:e[1]",t))},p=t=>{e("mo",{},t).textContent=l};if("top"===a)if("bot"===o){let t=e("mover",{accent:"false"},r);h(t),p(t)}else{let t=e("munder",{accentunder:"false"},r);p(t),h(t)}else if("bot"===o){let t=e("mover",{accent:"false"},r);p(t),h(t)}else{let t=e("munder",{accentunder:"false"},r);h(t),p(t)}}).match(n.el("m:borderBox"),(t,r,n)=>{let s,a=d(u("m:borderBoxPr[last()]/m:hideTop[last()]","m:val",t).toLowerCase()),o=d(u("m:borderBoxPr[last()]/m:hideBot[last()]","m:val",t).toLowerCase()),i=d(u("m:borderBoxPr[last()]/m:hideLeft[last()]","m:val",t).toLowerCase()),l=d(u("m:borderBoxPr[last()]/m:hideRight[last()]","m:val",t).toLowerCase()),h=d(u("m:borderBoxPr[last()]/m:strikeH[last()]","m:val",t).toLowerCase()),p=d(u("m:borderBoxPr[last()]/m:strikeV[last()]","m:val",t).toLowerCase()),m=d(u("m:borderBoxPr[last()]/m:strikeBLTR[last()]","m:val",t).toLowerCase()),f=d(u("m:borderBoxPr[last()]/m:strikeTLBR[last()]","m:val",t).toLowerCase());s=!(a&&o&&i&&l)||h||p||m||f?e("menclose",function({hideTop:e,hideBot:t,hideLeft:r,hideRight:n,strikeH:s,strikeV:a,strikeBLTR:o,strikeTLBR:i}){let l=[];e||t||r||n?(e||l.push("top"),t||l.push("bottom"),r||l.push("left"),n||l.push("right")):l.push("box");s&&l.push("horizontalstrike");a&&l.push("verticalstrike");o&&l.push("updiagonalstrike");i&&l.push("downdiagonalstrike");return{notation:l.join(" ")}}({hideTop:a,hideBot:o,hideLeft:i,hideRight:l,strikeH:h,strikeV:p,strikeBLTR:m,strikeTLBR:f}),r):e("mrow",{},r),n.walk(s,c("m:e[1]",t))}).match(n.el("m:bar"),(t,r,n)=>{if("top"===u("m:barPr/m:pos","m:val",t).toLowerCase()){let s=e("mover",{accent:"false"},r),a=e("mrow",{},s),o=e("mo",{},s);n.walk(a,c("m:e[1]",t)),o.textContent=""}else{let s=e("munder",{underaccent:"false"},r),a=e("mrow",{},s),o=e("mo",{},s);n.walk(a,c("m:e[1]",t)),o.textContent="_"}}).match([n.el("m:e"),n.el("m:den"),n.el("m:num"),n.el("m:lim"),n.el("m:sup"),n.el("m:sub")],(t,r,n)=>{let s=u("m:argPr[last()]/m:scrLvl","m:val",t);if(s){let t=e("mstyle",{scriptlevel:s},r);n.walk(t)}else n.walk(r)}).match(n.el("m:phant"),(t,r,n)=>{let s=u("m:phantPr[last()]/m:zeroWid[last()]","m:val",t).toLowerCase()||!1;s&&(s=m(s));let a=u("m:phantPr[last()]/m:zeroAsc[last()]","m:val",t).toLowerCase()||!1;a&&(a=m(a));let o,i=u("m:phantPr[last()]/m:zeroDesc[last()]","m:val",t).toLowerCase()||!1;if(i&&(i=m(i)),m(u("m:phantPr[last()]/m:show[last()]","m:val",t).toLowerCase()))o=e("mpadded",A({zeroWid:s,zeroAsc:a,zeroDesc:i}),r);else if(s||a||i){let t=e("mphantom",{},r);o=e("mpadded",A({zeroWid:s,zeroAsc:a,zeroDesc:i}),t)}else o=e("mphantom",{},r);let l=e("mrow",{},o);n.walk(l,c("m:e",t))}).run(r)};let S={"":"","":"","":"","":"","":"`","":"`","":"-","":"-","":".","":"","":"","":"","":"","":"~","":"~","":"","":"","":"","":"","":"^","":"^","":"","":"","":"","":""};function A({zeroWid:e,zeroAsc:t,zeroDesc:r}){let n={};return e&&(n.width="0in"),t&&(n.height="0in"),r&&(n.depth="0in"),n}function k(t,n,s){if(s.res)return;let o=a.implementation().createHTMLDocument(""),i=r(o,{},l),c=o.createElementNS("http://www.w3.org/1998/Math/MathML","math");c.setAttribute("display","inline"),e=i.el,s.result(c),s.walk(c)}return ut}(),ft=Ue(dt);function gt(e){if(!e)return"";try{const t=ft(e);if(!t)return"";console.log(t);return function(e){const t="http://www.w3.org/1998/Math/MathML";let r=null;if("string"==typeof e)try{const t=e=>{const t={"&nbsp;":"","&ensp;":"","&emsp;":"","&thinsp;":"","&times;":"","&middot;":"","&minus;":""};return e.replace(/&[a-zA-Z]+;/g,e=>t[e]??e)},n=new DOMParser,s=t(e),a=n.parseFromString(s,"application/xml");if(a.getElementsByTagName("parsererror").length>0||"parsererror"===a.documentElement?.localName?.toLowerCase())return e;r=1===a.documentElement?.nodeType?a.documentElement:null}catch{return"string"==typeof e?e:e?.outerHTML??""}else r=e;if(!r)return"";const n=e=>{const n=r.ownerDocument.createElementNS(t,"mo");return n.textContent=e,n},s=e=>{const r=e.ownerDocument.createElementNS(t,"mrow");for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t];"open"!==n.name&&"close"!==n.name&&"separators"!==n.name&&r.setAttribute(n.name,n.value)}const s=e.getAttribute("open"),a=e.getAttribute("close"),o=e.getAttribute("separators"),i=null!==s?s:"(",l=null!==a?a:")",c=null!==o?o:",",u=Array.from(e.children);i.length>0&&r.appendChild(n(i));const h=Array.from(c);u.forEach((e,t)=>{if(r.appendChild(e),!(t<u.length-1))return;if(0===h.length)return;const s=h[Math.min(t,h.length-1)];s&&s.length>0&&r.appendChild(n(s))}),l.length>0&&r.appendChild(n(l)),e.replaceWith(r)},a=[];a.push(...Array.from(r.getElementsByTagName("mfenced"))),r.localName&&"mfenced"===r.localName.toLowerCase()&&a.push(r);for(let e=a.length-1;e>=0;e--)s(a[e]);return r.outerHTML??(new XMLSerializer).serializeToString(r)}("string"==typeof t?t:t.outerHTML??"")}catch(e){return console.log(e),""}}const bt={pos:0,leader:"none",style:"left"};function yt(e,t,r,n=.75){const s=e.closest("p"),a=e.getBoundingClientRect(),o=s.getBoundingClientRect(),i=getComputedStyle(s),l=t?.length>0?t.map(e=>({pos:vt(e.position),leader:e.leader,style:e.style})).sort((e,t)=>e.pos-t.pos):[bt],c=l[l.length-1],u=o.width*n,h=vt(r);let p=c.pos+h;if(p<u)for(;p<u&&l.length<50;p+=h)l.push({...bt,pos:p});const m=parseFloat(i.marginLeft),d=o.left+m,f=(a.left-d)*n,g=l.find(e=>"clear"!=e.style&&e.pos>f);if(null==g)return;let b=1;if("right"==g.style||"center"==g.style){const t=Array.from(s.querySelectorAll(`.${e.className}`)),r=t.indexOf(e)+1,a=document.createRange();a.setStart(e,1),r<t.length?a.setEndBefore(t[r]):a.setEndAfter(s);const i="center"==g.style?.5:1,l=a.getBoundingClientRect(),c=l.left+i*l.width-(o.left-m);b=g.pos-c*n}else b=g.pos-f;switch(e.innerHTML="&nbsp;",e.style.textDecoration="inherit",e.style.wordSpacing=`${b.toFixed(0)}pt`,g.leader){case"dot":case"middleDot":e.style.textDecoration="underline",e.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":e.style.textDecoration="underline"}}function vt(e){return parseFloat(e)}const Nt="http://www.w3.org/2000/svg",Et="http://www.w3.org/1998/Math/MathML";class wt{constructor(e){this.htmlDocument=e,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(e,t,r=null,n){this.document=e,this.options=n,this.className=n.className,this.rootSelector=n.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),St(r=r||t),St(t),r.appendChild(this.createComment("docxjs library predefined styles")),r.appendChild(this.renderDefaultStyle()),e.themePart&&(r.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),r.appendChild(this.createComment("docxjs document styles")),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.prodessNumberings(e.numberingPart.domNumberings),r.appendChild(this.createComment("docxjs document numbering styles")),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),e.footnotesPart&&(this.footnoteMap=o(e.footnotesPart.notes,e=>e.id)),e.endnotesPart&&(this.endnoteMap=o(e.endnotesPart.notes,e=>e.id)),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),!n.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r);var s=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(s)):At(t,s),this.commentHighlight&&n.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(e=>e()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(e,t){const r={},n=e.theme?.fontScheme;n&&(n.majorFont&&(r["--docx-majorHAnsi-font"]=n.majorFont.latinTypeface),n.minorFont&&(r["--docx-minorHAnsi-font"]=n.minorFont.latinTypeface));const s=e.theme?.colorScheme;if(s)for(let[e,t]of Object.entries(s.colors))r[`--docx-${e}-color`]=`#${t}`;const a=this.styleToString(`.${this.className}`,r);t.appendChild(this.createStyleElement(a))}renderFontTable(e,t){for(let r of e.fonts)for(let e of r.embedFontRefs)this.tasks.push(this.document.loadFont(e.id,e.key).then(s=>{const a={"font-family":n(r.name),src:`url(${s})`};"bold"!=e.type&&"boldItalic"!=e.type||(a["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(a["font-style"]="italic");const o=this.styleToString("@font-face",a);t.appendChild(this.createComment(`docxjs ${r.name} font`)),t.appendChild(this.createStyleElement(o))}))}processStyleName(e){return e?`${this.className}_${function(e){return e?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}(e)}`:this.className}processStyles(e){const t=o(e.filter(e=>null!=e.id),e=>e.id);for(const n of e.filter(e=>e.basedOn)){var r=t[n.basedOn];if(r){n.paragraphProps=l(n.paragraphProps,r.paragraphProps),n.runProps=l(n.runProps,r.runProps);for(const e of r.styles){const t=n.styles.find(t=>t.target==e.target);t?this.copyStyleProperties(e.values,t.values):n.styles.push({...e,values:{...e.values}})}}else this.options.debug&&console.warn(`Can't find base style ${n.basedOn}`)}for(let t of e)t.cssName=this.processStyleName(t.id);return t}prodessNumberings(e){for(let t of e.filter(e=>e.pStyleName)){const e=this.findStyle(t.pStyleName);e?.paragraphProps?.numbering&&(e.paragraphProps.numbering.level=t.level)}}processElement(e){if(e.children)for(var t of e.children)t.parent=e,t.type==D.Table?this.processTable(t):this.processElement(t)}processTable(e){for(var t of e.children)for(var r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}copyStyleProperties(e,t,r=null){if(!e)return t;for(var n of(null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e)),r))e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n]);return t}createPageElement(e,t){var r=this.createElement("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height))),r}createSectionContent(e){var t=this.createElement("article");return e.columns&&e.columns.numberOfColumns&&(t.style.columnCount=`${e.columns.numberOfColumns}`,t.style.columnGap=e.columns.space,e.columns.separator&&(t.style.columnRule="1px solid black")),t}renderSections(e){const t=[];this.processElement(e);const r=this.splitBySection(e.children,e.props),n=this.groupByPageBreaks(r);let s=null;for(let r=0,o=n.length;r<o;r++){this.currentFootnoteIds=[];let i=n[r][0].sectProps;const l=this.createPageElement(this.className,i);this.renderStyleValues(e.cssStyle,l),this.options.renderHeaders&&this.renderHeaderFooter(i.headerRefs,i,t.length,s!=i,l);for(const e of n[r]){var a=this.createSectionContent(e.sectProps);this.renderElements(e.elements,a),l.appendChild(a),i=e.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,l),this.options.renderEndnotes&&r==o-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,l),this.options.renderFooters&&this.renderHeaderFooter(i.footerRefs,i,t.length,s!=i,l),t.push(l),s=i}return t}renderHeaderFooter(e,t,r,n,s){if(e){var a=(t.titlePage&&n?e.find(e=>"first"==e.type):null)??(r%2==1?e.find(e=>"even"==e.type):null)??e.find(e=>"default"==e.type),o=a&&this.document.findPartByRelId(a.id,this.document.documentPart);if(o){this.currentPart=o,this.usedHederFooterParts.includes(o.path)||(this.processElement(o.rootElement),this.usedHederFooterParts.push(o.path));const[e]=this.renderElements([o.rootElement],s);t?.pageMargins&&(o.rootElement.type===D.Header?(e.style.marginTop=`calc(${t.pageMargins.header} - ${t.pageMargins.top})`,e.style.minHeight=`calc(${t.pageMargins.top} - ${t.pageMargins.header})`):o.rootElement.type===D.Footer&&(e.style.marginBottom=`calc(${t.pageMargins.footer} - ${t.pageMargins.bottom})`,e.style.minHeight=`calc(${t.pageMargins.bottom} - ${t.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(e){return e.type==D.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"==e.break)}isPageBreakSection(e,t){return!!e&&(!!t&&(e.pageSize?.orientation!=t.pageSize?.orientation||e.pageSize?.width!=t.pageSize?.width||e.pageSize?.height!=t.pageSize?.height))}splitBySection(e,t){var r={sectProps:null,elements:[],pageBreak:!1},n=[r];for(let t of e){if(t.type==D.Paragraph){const e=this.findStyle(t.styleName);e?.paragraphProps?.pageBreakBefore&&(r.sectProps=s,r.pageBreak=!0,r={sectProps:null,elements:[],pageBreak:!1},n.push(r))}if(r.elements.push(t),t.type==D.Paragraph){const e=t;var s=e.sectionProps,a=-1,o=-1;if(this.options.breakPages&&e.children&&(a=e.children.findIndex(e=>-1!=(o=e.children?.findIndex(this.isPageBreakElement.bind(this))??-1))),(s||-1!=a)&&(r.sectProps=s,r.pageBreak=-1!=a,r={sectProps:null,elements:[],pageBreak:!1},n.push(r)),-1!=a){let n=e.children[a],s=o<n.children.length-1;if(a<e.children.length-1||s){var i=t.children,l={...t,children:i.slice(a)};if(t.children=i.slice(0,a),r.elements.push(l),s){let e=n.children,r={...n,children:e.slice(0,o)};t.children.push(r),n.children=e.slice(o)}}}}}let c=null;for(let e=n.length-1;e>=0;e--)null==n[e].sectProps?n[e].sectProps=c??t:c=n[e].sectProps;return n}groupByPageBreaks(e){let t,r=[];const n=[r];for(let s of e)r.push(s),(this.options.ignoreLastRenderedPageBreak||s.pageBreak||this.isPageBreakSection(t,s.sectProps))&&n.push(r=[]),t=s.sectProps;return n.filter(e=>e.length>0)}renderWrapper(e){return this.createElement("div",{className:`${this.className}-wrapper`},e)}renderDefaultStyle(){var e=this.className,t=`\n.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(t=`@media not print { ${t} }`);var r=`${t}\n.${e} { color: black; hyphens: auto; text-underline-position: from-font; }\nsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\nsection.${e}>article { margin-bottom: auto; z-index: 1; }\nsection.${e}>footer { z-index: 1; }\n.${e} table { border-collapse: collapse; }\n.${e} table td, .${e} table th { vertical-align: top; }\n.${e} p { margin: 0pt; min-height: 1em; }\n.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n.${e} a { color: inherit; text-decoration: inherit; }\n.${e} svg { fill: transparent; }\n`;return this.options.renderComments&&(r+=`\n.${e}-comment-ref { cursor: default; }\n.${e}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }\n.${e}-comment-ref:hover~.${e}-comment-popover { display: block; }\n.${e}-comment-author,.${e}-comment-date { font-size: 0.875rem; color: #888; }\n`),this.createStyleElement(r)}renderNumbering(e,t){var r="",n=[];for(var s of e){var a=`p.${this.numberingClass(s.id,s.level)}`,o="none";if(s.bullet){let e=`--${this.className}-${s.bullet.src}`.toLowerCase();r+=this.styleToString(`${a}:before`,{content:"' '",display:"inline-block",background:`var(${e})`},s.bullet.style),this.tasks.push(this.document.loadNumberingImage(s.bullet.src).then(r=>{var n=`${this.rootSelector} { ${e}: url(${r}) }`;t.appendChild(this.createStyleElement(n))}))}else if(s.levelText){let e=this.numberingCounter(s.id,s.level);const t=e+" "+(s.start-1);s.level>0&&(r+=this.styleToString(`p.${this.numberingClass(s.id,s.level-1)}`,{"counter-set":t})),n.push(t),r+=this.styleToString(`${a}:before`,{content:this.levelTextToContent(s.levelText,s.suff,s.id,this.numFormatToCssValue(s.format)),"counter-increment":e,...s.rStyle})}else o=this.numFormatToCssValue(s.format);r+=this.styleToString(a,{display:"list-item","list-style-position":"inside","list-style-type":o,...s.pStyle})}return n.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":n.join(" ")})),this.createStyleElement(r)}renderStyles(e){var t="";const r=this.styleMap,n=o(e.filter(e=>e.isDefault),e=>e.target);for(const o of e){var s=o.styles;if(o.linked){var a=o.linked&&r[o.linked];a?s=s.concat(a.styles):this.options.debug&&console.warn(`Can't find linked style ${o.linked}`)}for(const e of s){var i=`${o.target??""}.${o.cssName}`;o.target!=e.target&&(i+=` ${e.target}`),n[o.target]==o&&(i=`.${this.className} ${o.target}, `+i),t+=this.styleToString(i,e.values)}}return this.createStyleElement(t)}renderNotes(e,t,r){var n=e.map(e=>t[e]).filter(e=>e);if(n.length>0){var s=this.createElement("ol",null,this.renderElements(n));r.appendChild(s)}}renderElement(e){switch(e.type){case D.Paragraph:return this.renderParagraph(e);case D.BookmarkStart:return this.renderBookmarkStart(e);case D.BookmarkEnd:return null;case D.Run:return this.renderRun(e);case D.Table:return this.renderTable(e);case D.Row:return this.renderTableRow(e);case D.Cell:return this.renderTableCell(e);case D.Hyperlink:return this.renderHyperlink(e);case D.SmartTag:return this.renderSmartTag(e);case D.Drawing:return this.renderDrawing(e);case D.Image:return this.renderImage(e);case D.Text:case D.Text:return this.renderText(e);case D.DeletedText:return this.renderDeletedText(e);case D.Tab:return this.renderTab(e);case D.Symbol:return this.renderSymbol(e);case D.Break:return this.renderBreak(e);case D.Footer:return this.renderContainer(e,"footer");case D.Header:return this.renderContainer(e,"header");case D.Footnote:case D.Endnote:return this.renderContainer(e,"li");case D.FootnoteReference:return this.renderFootnoteReference(e);case D.EndnoteReference:return this.renderEndnoteReference(e);case D.NoBreakHyphen:return this.createElement("wbr");case D.VmlPicture:return this.renderVmlPicture(e);case D.VmlElement:return this.renderVmlElement(e);case D.MmlMath:{const t=gt(e._raw);if(t){const e=this.createElement("span");return e.innerHTML=t,e}return this.renderContainerNS(e,Et,"math",{xmlns:Et})}case D.MmlMathParagraph:{const t=gt(e._raw);if(t){const e=this.createElement("span");return e.innerHTML=t,e}return this.renderContainer(e,"span")}case D.MmlFraction:return this.renderContainerNS(e,Et,"mfrac");case D.MmlBase:return this.renderContainerNS(e,Et,e.parent.type==D.MmlMatrixRow?"mtd":"mrow");case D.MmlNumerator:case D.MmlDenominator:case D.MmlFunction:case D.MmlLimit:case D.MmlBox:return this.renderContainerNS(e,Et,"mrow");case D.MmlGroupChar:return this.renderMmlGroupChar(e);case D.MmlLimitLower:return this.renderContainerNS(e,Et,"munder");case D.MmlMatrix:return this.renderContainerNS(e,Et,"mtable");case D.MmlMatrixRow:return this.renderContainerNS(e,Et,"mtr");case D.MmlRadical:return this.renderMmlRadical(e);case D.MmlSuperscript:return this.renderContainerNS(e,Et,"msup");case D.MmlSubscript:return this.renderContainerNS(e,Et,"msub");case D.MmlDegree:case D.MmlSuperArgument:case D.MmlSubArgument:return this.renderContainerNS(e,Et,"mn");case D.MmlFunctionName:return this.renderContainerNS(e,Et,"ms");case D.MmlDelimiter:return this.renderMmlDelimiter(e);case D.MmlRun:return this.renderMmlRun(e);case D.MmlNary:return this.renderMmlNary(e);case D.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case D.MmlBar:return this.renderMmlBar(e);case D.MmlEquationArray:return this.renderMllList(e);case D.Inserted:return this.renderInserted(e);case D.Deleted:return this.renderDeleted(e);case D.CommentRangeStart:return this.renderCommentRangeStart(e);case D.CommentRangeEnd:return this.renderCommentRangeEnd(e);case D.CommentReference:return this.renderCommentReference(e);case D.AltChunk:return this.renderAltChunk(e)}return null}renderElements(e,t){if(null==e)return null;var r=e.flatMap(e=>this.renderElement(e)).filter(e=>null!=e);return t&&At(t,r),r}renderContainer(e,t,r){return this.createElement(t,r,this.renderElements(e.children))}renderContainerNS(e,t,r,n){return this.createElementNS(t,r,n,this.renderElements(e.children))}renderParagraph(e){var t=this.renderContainer(e,"p");const r=this.findStyle(e.styleName);e.tabs??(e.tabs=r?.paragraphProps?.tabs),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e);const n=e.numbering??r?.paragraphProps?.numbering;return n&&t.classList.add(this.numberingClass(n.id,n.level)),t}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderHyperlink(e){var t=this.renderContainer(e,"a");this.renderStyleValues(e.cssStyle,t);let r="";if(e.id){const t=this.document.documentPart.rels.find(t=>t.id==e.id&&"External"===t.targetMode);r=t?.target??r}return e.anchor&&(r+=`#${e.anchor}`),t.href=r,t}renderSmartTag(e){return this.renderContainer(e,"span")}renderCommentRangeStart(e){if(!this.options.renderComments)return null;const t=new Range;this.commentHighlight?.add(t);const r=this.htmlDocument.createComment(`start of comment #${e.id}`);return this.later(()=>t.setStart(r,0)),this.commentMap[e.id]=t,r}renderCommentRangeEnd(e){if(!this.options.renderComments)return null;const t=this.commentMap[e.id],r=this.htmlDocument.createComment(`end of comment #${e.id}`);return this.later(()=>t?.setEnd(r,0)),r}renderCommentReference(e){if(!this.options.renderComments)return null;var t=this.document.commentsPart?.commentMap[e.id];if(!t)return null;const r=new DocumentFragment,n=this.createElement("span",{className:`${this.className}-comment-ref`},[""]),s=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(t,s),r.appendChild(this.htmlDocument.createComment(`comment #${t.id} by ${t.author} on ${t.date}`)),r.appendChild(n),r.appendChild(s),r}renderAltChunk(e){if(!this.options.renderAltChunks)return null;var t=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(e.id,this.currentPart).then(e=>{t.srcdoc=e})),t}renderCommentContent(e,t){t.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[e.author])),t.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(e.date).toLocaleString()])),this.renderElements(e.children,t)}renderDrawing(e){var t=this.renderContainer(e,"div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=this.createElement("img"),r=e.cssStyle?.transform;if(this.renderStyleValues(e.cssStyle,t),e.srcRect&&e.srcRect.some(e=>0!=e)){var[n,s,a,o]=e.srcRect;r=`scale(${1/(1-n-a)}, ${1/(1-s-o)})`,t.style["clip-path"]=`rect(${(100*s).toFixed(2)}% ${(100*(1-a)).toFixed(2)}% ${(100*(1-o)).toFixed(2)}% ${(100*n).toFixed(2)}%)`}return e.rotation&&(r=`rotate(${e.rotation}deg) ${r??""}`),t.style.transform=r?.trim(),this.document&&this.tasks.push(this.document.loadDocumentImage(e.src,this.currentPart).then(e=>{t.src=e})),t}renderText(e){return this.htmlDocument.createTextNode(e.text)}renderDeletedText(e){return this.options.renderEndnotes?this.htmlDocument.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?this.createElement("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderElements(e.children)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){var t=this.createElement("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderFootnoteReference(e){var t=this.createElement("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){var t=this.createElement("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){var t=this.createElement("span");if(t.innerHTML="&emsp;",this.options.experimental){t.className=this.tabStopClass();var r=function(e,t){var r=e.parent;for(;null!=r&&r.type!=t;)r=r.parent;return r}(e,D.Paragraph)?.tabs;this.currentTabs.push({stops:r,span:t})}return t}renderBookmarkStart(e){return this.createElement("span",{id:e.name})}renderRun(e){if(e.fieldRun)return null;const t=this.createElement("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const r=this.createElement(e.verticalAlign);this.renderElements(e.children,r),t.appendChild(r)}else this.renderElements(e.children,t);return t}renderTable(e){let t=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=this.createElement("colgroup");for(let r of e){let e=this.createElement("col");r.width&&(e.style.width=r.width),t.appendChild(e)}return t}renderTableRow(e){let t=this.createElement("tr");return this.currentCellPosition.col=0,e.gridBefore&&t.appendChild(this.renderTableCellPlaceholder(e.gridBefore)),this.renderClass(e,t),this.renderElements(e.children,t),this.renderStyleValues(e.cssStyle,t),e.gridAfter&&t.appendChild(this.renderTableCellPlaceholder(e.gridAfter)),this.currentCellPosition.row++,t}renderTableCellPlaceholder(e){const t=this.createElement("td",{colSpan:e});return t.style.border="none",t}renderTableCell(e){let t=this.renderContainer(e,"td");const r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){return this.renderContainer(e,"div")}renderVmlElement(e){var t=this.createSvgElement("svg");t.setAttribute("style",e.cssStyleText);const r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then(e=>r.setAttribute("href",e))),t.appendChild(r),requestAnimationFrame(()=>{const e=t.firstElementChild.getBBox();t.setAttribute("width",`${Math.ceil(e.x+e.width)}`),t.setAttribute("height",`${Math.ceil(e.y+e.height)}`)}),t}renderVmlChildElement(e){const t=this.createSvgElement(e.tagName);Object.entries(e.attrs).forEach(([e,r])=>t.setAttribute(e,r));for(let r of e.children)r.type==D.VmlElement?t.appendChild(this.renderVmlChildElement(r)):t.appendChild(...c(this.renderElement(r)));return t}renderMmlRadical(e){const t=e.children.find(e=>e.type==D.MmlBase);if(e.props?.hideDegree)return this.createElementNS(Et,"msqrt",null,this.renderElements([t]));const r=e.children.find(e=>e.type==D.MmlDegree);return this.createElementNS(Et,"mroot",null,this.renderElements([t,r]))}renderMmlDelimiter(e){const t=[];return t.push(this.createElementNS(Et,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(this.createElementNS(Et,"mo",null,[e.props.endChar??")"])),this.createElementNS(Et,"mrow",null,t)}renderMmlNary(e){const t=[],r=o(e.children,e=>e.type),n=r[D.MmlSuperArgument],s=r[D.MmlSubArgument],a=n?this.createElementNS(Et,"mo",null,c(this.renderElement(n))):null,i=s?this.createElementNS(Et,"mo",null,c(this.renderElement(s))):null,l=this.createElementNS(Et,"mo",null,[e.props?.char??""]);return a||i?t.push(this.createElementNS(Et,"munderover",null,[l,i,a])):a?t.push(this.createElementNS(Et,"mover",null,[l,a])):i?t.push(this.createElementNS(Et,"munder",null,[l,i])):t.push(l),t.push(...this.renderElements(r[D.MmlBase].children)),this.createElementNS(Et,"mrow",null,t)}renderMmlPreSubSuper(e){const t=[],r=o(e.children,e=>e.type),n=r[D.MmlSuperArgument],s=r[D.MmlSubArgument],a=n?this.createElementNS(Et,"mo",null,c(this.renderElement(n))):null,i=s?this.createElementNS(Et,"mo",null,c(this.renderElement(s))):null,l=this.createElementNS(Et,"mo",null);return t.push(this.createElementNS(Et,"msubsup",null,[l,i,a])),t.push(...this.renderElements(r[D.MmlBase].children)),this.createElementNS(Et,"mrow",null,t)}renderMmlGroupChar(e){const t="bot"===e.props.verticalJustification?"mover":"munder",r=this.renderContainerNS(e,Et,t);return e.props.char&&r.appendChild(this.createElementNS(Et,"mo",null,[e.props.char])),r}renderMmlBar(e){const t=this.renderContainerNS(e,Et,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){const t=this.createElementNS(Et,"ms",null,this.renderElements(e.children));return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),t}renderMllList(e){const t=this.createElementNS(Et,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(let r of this.renderElements(e.children))t.appendChild(this.createElementNS(Et,"mtr",null,[this.createElementNS(Et,"mtd",null,[r])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(e,t,r=null){let n=`${e} {\r\n`;for(const e in t)e.startsWith("$")||(n+=`  ${e}: ${t[e]};\r\n`);return r&&(n+=r),n+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,n){return`"${e.replace(/%\d*/g,e=>{let t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${n})"`})}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const e=function(e=document.body){const t=document.createElement("div");t.style.width="100pt",e.appendChild(t);const r=100/t.offsetWidth;return e.removeChild(t),r}();for(let t of this.currentTabs)yt(t.span,t.stops,this.defaultTabSize,e)},500)}createElementNS(e,t,r,n){var s=e?this.htmlDocument.createElementNS(e,t):this.htmlDocument.createElement(t);return Object.assign(s,r),n&&At(s,n),s}createElement(e,t,r){return this.createElementNS(void 0,e,t,r)}createSvgElement(e,t,r){return this.createElementNS(Nt,e,t,r)}createStyleElement(e){return this.createElement("style",{innerHTML:e})}createComment(e){return this.htmlDocument.createComment(e)}later(e){this.postRenderTasks.push(e)}}function St(e){e.innerHTML=""}function At(e,t){t.forEach(t=>{return e.appendChild("string"==typeof(r=t)||r instanceof String?document.createTextNode(t):t);var r})}const kt={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function Tt(e,t){const r={...kt,...t};return ve.load(e,new Fe(r),r)}async function Ct(e,t,r,n){const s={...kt,...n},a=new wt(window.document);return await a.render(e,t,r,s)}e.defaultOptions=kt,e.parseAsync=Tt,e.renderAsync=async function(e,t,r,n){const s=await Tt(e,n);return await Ct(s,t,r,n),s},e.renderDocument=Ct});
//# sourceMappingURL=docx-preview.min.js.map
